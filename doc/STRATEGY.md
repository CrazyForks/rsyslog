# The Rsyslog Documentation Strategy

**Version: 1.0**

**Related Document:** `IMPLEMENTATION_PLAN.md`

**Status: Active**

This document outlines the official strategy for the rsyslog project's documentation. It is a living document, subject to revision as our tools and processes evolve. Its purpose is to ensure our documentation is **authoritative**, **sustainable**, and **intelligent**, serving both human system administrators and AI agents as a primary source of truth.

## Core Principles

1.  **Docs-as-Code**: Documentation is treated with the same rigor as application code. It lives in the same repository, is version-controlled, and is integrated into our CI/CD pipelines.
2.  **Single Source of Truth**: We will relentlessly eliminate information duplication. A piece of information should exist in one place and be referenced everywhere else.
3.  **Automation First**: We will automate every process possible, from generation and validation to drift detection and contribution checks.
4.  **Hybrid Model**: We recognize that great documentation requires both machine-driven accuracy for reference material and human-authored clarity for narrative content.

---

## Pillar 1: The Automated Foundation (Code-Driven Reference)

This pillar ensures that our reference documentation is always an accurate reflection of the source code, even if manual updates are missed during development.

* **Authoritative Source**: The C source code is the ultimate source of truth for all modules, configuration parameters, and directives.
* **Generation Toolchain**:
    * **Doxygen**: Parses standardized comment blocks and code structure from `.c` files into an intermediate XML format.
    * **Sphinx**: The core documentation build system.
    * **Breathe**: A Sphinx extension that bridges Doxygen and Sphinx, rendering the XML as clean HTML and man pages.
* **Handling Undocumented Changes**:
    1.  A CI job runs nightly (or on commit) to analyze the source code and compare it to the current documentation.
    2.  If this "code analysis agent" detects a new or changed parameter that is not documented, it will **not** fail the build.
    3.  Instead, it will automatically create a **new issue** in the project's GitHub issue tracker, tagged with `documentation` and `autogenerated`. This creates a trackable "documentation debt" item.

---

## Pillar 2: The Narrative Layer (Human-Authored Guides)

This layer provides context, learning paths, and practical solutions. This content is manually authored but automatically validated.

* **Validated Example Library**:
    * All complete configuration examples will be stored in a dedicated `doc/examples/` directory.
    * A CI job will test these examples for syntactic validity to ensure they are guaranteed to work.
    * Tutorials and guides will **not** contain inline, hardcoded configurations. They will use Sphinx's `.. literalinclude:: ../examples/my_validated_example.conf` directive to pull in these tested examples.
* **Diagrams as Code**:
    * All diagrams and schematics will be created using **Mermaid.js**.
    * The `sphinx-mermaid` extension will be used to render these text-based diagrams directly within the documentation, making them version-controllable.
* **Content Migration**: High-value, existing content (such as from `rainer.gerhards.net`) will be migrated, converted to RST, and integrated directly into the `doc/source/tutorials/` section, enriching it with cross-references and standard formatting.

---

## Pillar 3: Quality & Contribution Framework

This pillar defines the processes that ensure our documentation is high-quality, trustworthy, and easy to contribute to.

* **Documentation CI Pipeline**: Any pull request that modifies documentation will trigger a CI pipeline that:
    1.  **Builds the Docs**: Runs `make html` to ensure no Sphinx errors.
    2.  **Runs the "Drift Detector"**: A custom linter script scans all `.rst` files for rsyslog-specific technical terms (e.g., `$WorkDirectory`) and validates them against the authoritative list generated from the source code. An unknown term will fail the build, preventing typos and outdated information from being merged.
* **AI-Powered Review**: As a supplementary check, a GitHub Action can be configured to use an LLM to review the clarity, grammar, and style of documentation changes in a pull request, posting feedback as a comment.
* **User Feedback**: Every page will feature an "Edit on GitHub" link to provide a low-friction way for users to suggest improvements. This is configured in `conf.py` via the `html_context`.

---

## Pillar 4: Distribution & Format Integration

This pillar defines how documentation is delivered to end-users and how legacy formats are handled.

* **Man Page Generation**:
    * Man pages are not written manually. They are **generated** from the same RST source files as the HTML documentation.
    * Content from existing man pages will be migrated to RST files under `doc/source/man/`.
    * The `Makefile` will include the `make man` target, which uses Sphinx's man-page builder. The generated pages will be included in the release tarball.
* **Official Versioning Policy**:
    > This online documentation reflects the latest development version (`main` branch) of rsyslog. It contains the most current information but may include features not yet available in a stable release.
    >
    > For stable versions, the authoritative documentation is bundled within the official release tarballs. Linux distributions like Red Hat, Ubuntu, and others build their documentation packages directly from these tarballs. **If you have installed rsyslog via a distribution's package manager, please refer to the documentation provided by that package as your primary source of truth.**

---

## Pillar 5: Ecosystem Integration (External & Platform Docs)

This pillar defines how we integrate with related external projects and platform-specific documentation.

* **External Projects (e.g., Rsyslog Windows Agent)**:
    * To link to related but separate documentation sets, we will use a combination of `git submodule` and the Sphinx `intersphinx` extension.
    * This allows us to cross-reference content between projects seamlessly, making it feel like a single, unified documentation set to the user.
* **Cloud & Container Deployments**:
    * A dedicated top-level section, `08_deployment_guides/`, will be created in the documentation.
    * This section will contain sub-folders for major platforms (e.g., `container_deployment/`, `aws_deployment/`), providing comprehensive, validated guides for modern deployment scenarios.

---

## Pillar 6: Content Amplification & Authority Building

This pillar outlines our strategy to combat misinformation and establish the official documentation as the canonical source of truth.

* **Technical SEO**:
    * We will use the `sphinx-sitemap` extension to generate a `sitemap.xml` to improve indexing.
    * We will embed `Schema.org` structured data (e.g., `TechArticle`, `HowTo`) into our HTML templates to provide explicit context to search engines and AI crawlers.
* **Strategic Syndication**:
    * Key tutorials will be periodically published on high-authority external sites (e.g., dev.to).
    * **Crucially**, these syndicated articles **must** use a `rel="canonical"` link pointing back to the original article in the official rsyslog documentation to centralize SEO authority.
* **Answer Hubs**: When answering questions on sites like Stack Overflow, community members are encouraged to provide a brief summary and then link directly to the relevant page in the official documentation.

---

## Maintaining This Strategy

This document is the "single source of truth" for our documentation process.

* **Location**: It is stored at `doc/STRATEGY.md` within the main rsyslog repository.
* **Discoverability**: A `CONTRIBUTING.md` file at the repository root links directly to this strategy, and a pull request template (`.github/pull_request_template.md`) includes a checklist item requiring contributors to have read it.
* **Enforcement**: The strategy is primarily enforced through the automated CI checks. If the CI pipeline passes, the contribution is considered compliant.
