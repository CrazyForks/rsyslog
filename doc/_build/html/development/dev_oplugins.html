<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="The rsyslog queue object" href="dev_queue.html" /><link rel="prev" title="rsyslog code style" href="dev_codestyle.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>Writing Rsyslog Output Plugins - rsyslog 8.2508 daily stable documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/rsyslog.css?v=6406a7f4" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">rsyslog 8.2508 daily stable documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">rsyslog 8.2508 daily stable documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../about/index.html">About rsyslog</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of About rsyslog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/ai_first.html">AI-First: Our Vision for rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/history.html">History and Future of rsyslog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/index.html">Getting Started with rsyslog</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Getting Started with rsyslog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html">Installing rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/basic_configuration.html">Basic Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/understanding_default_config.html">Understanding the Default Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/forwarding_logs.html">Forwarding Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/next_steps.html">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../configuration/index.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Configuration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/basic_structure.html">Basic Structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_output.html">Output Modules</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Output Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omamqp1.html">omamqp1: AMQP 1.0 Messaging Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omazureeventhubs.html">omazureeventhubs: Microsoft Azure Event Hubs Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omclickhouse.html">omclickhouse: ClickHouse Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omczmq.html">omczmq: Output module for ZeroMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omdtls.html">omdtls: Output Module for DTLS Protocol over UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omelasticsearch.html">omelasticsearch: Elasticsearch Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omfile.html">omfile: File Output Module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/modules/omfwd.html">omfwd: syslog Forwarding Output Module</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of omfwd: syslog Forwarding Output Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/modules/omfwd/parameters/basic.html">Basic Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/modules/omfwd/parameters/module.html">Module Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhdfs.html">omhdfs: Hadoop Filesystem Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhiredis.html">omhiredis: Redis Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhttp.html">omhttp: HTTP Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhttpfs.html">omhttpfs: Hadoop HTTPFS Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omjournal.html">omjournal: Systemd Journal Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omkafka.html">omkafka: write to Apache Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omlibdbi.html">omlibdbi: Generic Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ommail.html">ommail: Mail Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ommongodb.html">ommongodb: MongoDB Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ommysql.html">ommysql: MariaDB/MySQL Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omoracle.html">omoracle: Oracle Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ompgsql.html">PostgreSQL Database Output Module (ompgsql)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ompipe.html">ompipe: Pipe Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omprog.html">omprog: Program integration Output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omrabbitmq.html">omrabbitmq: RabbitMQ output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omrelp.html">omrelp: RELP Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omruleset.html">omruleset: ruleset output/including module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omsendertrack.html">omsendertrack: Sender Tracking Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omsnmp.html">omsnmp: SNMP Trap Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omstdout.html">omstdout: stdout output module (testbench tool)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omudpspoof.html">omudpspoof: UDP spoofing output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omusrmsg.html">omusrmsg: notify users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omuxsock.html">omuxsock: Unix sockets Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/sigprov_gt.html">GuardTime Log Signature Provider (gt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/sigprov_ksi.html">Keyless Signature Infrastructure Provider (ksi)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/sigprov_ksi12.html">KSI Signature Provider (rsyslog-ksi-ls12)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_input.html">Input Modules</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Input Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/im3195.html">im3195: RFC3195 Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imbatchreport.html">imbatchreport: Batch report input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imczmq.html">imczmq: Input module for ZeroMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imdocker.html">imdocker: Docker Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imdtls.html">imdtls: Input Module for DTLS Protocol over UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imfile.html">imfile: Text File Input Module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/modules/imgssapi.html">imgssapi: GSSAPI Syslog Input Module</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of imgssapi: GSSAPI Syslog Input Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/modules/gssapi.html">GSSAPI module support in rsyslog v3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imhiredis.html">Imhiredis: Redis input plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imhttp.html">imhttp: HTTP input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imjournal.html">imjournal: Systemd Journal Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imkafka.html">imkafka: read from Apache Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imklog.html">imklog: Kernel Log Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imkmsg.html">imkmsg: /dev/kmsg Log Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/immark.html">immark: Mark Message Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/impcap.html">Impcap: network traffic capture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/improg.html">improg: Program integration input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/impstats.html">impstats: Generate Periodic Statistics of Internal Counters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imptcp.html">imptcp: Plain TCP Syslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imrelp.html">imrelp: RELP Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imsolaris.html">imsolaris: Solaris Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imtcp.html">imtcp: TCP Syslog Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imtuxedoulog.html">imtuxedoulog: Tuxedo ULOG input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imudp.html">imudp: UDP Syslog Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imuxsock.html">imuxsock: Unix Socket Input Module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_parser.html">Parser Modules</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parser Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmciscoios.html">pmciscoios</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmdb2diag.html">pmdb2diag: DB2 Diag file parser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmlastmsg.html">pmlastmsg: last message repeated n times</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmnormalize.html">Log Message Normalization Parser Module (pmnormalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmnull.html">pmnull: Syslog Null Parser Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmrfc3164.html">pmrfc3164: Parse RFC3164-formatted messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmrfc3164sd.html">pmrfc3164sd: Parse RFC5424 structured data inside RFC3164 messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmrfc5424.html">pmrfc5424: Parse RFC5424-formatted messages</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_messagemod.html">Message Modification Modules</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Message Modification Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmaitag.html">AI-based classification (mmaitag)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmanon.html">IP Address Anonymization Module (mmanon)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmcount.html">mmcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmdarwin.html">Darwin connector (mmdarwin)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmdblookup.html">MaxMind/GeoIP DB lookup (mmdblookup)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmexternal.html">Support module for external message modification modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmfields.html">Fields Extraction Module (mmfields)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmjsonparse.html">JSON/CEE Structured Content Extraction Module (mmjsonparse)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmkubernetes.html">Kubernetes Metadata Module (mmkubernetes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmnormalize.html">Log Message Normalization Module (mmnormalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmpstrucdata.html">RFC5424 structured data parsing module (mmpstrucdata)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmrfc5424addhmac.html">mmrfc5424addhmac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmrm1stspace.html">mmrm1stspace: First Space Modification Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmsequence.html">Number generator and counter module (mmsequence)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmsnmptrapd.html">mmsnmptrapd message modification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmtaghostname.html">mmtaghostname: message modification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmutf8fix.html">Fix invalid UTF-8 Sequences (mmutf8fix)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/modules/idx_stringgen.html">String Generator Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/modules/idx_library.html">Library Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/templates.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/properties.html">rsyslog Properties</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/property_replacer.html">The Property Replacer</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of The Property Replacer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/nomatch.html">Property Replacer nomatch mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/filters.html">Filter Conditions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../rainerscript/index.html">RainerScript</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of RainerScript</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/data_types.html">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/expressions.html">Expressions</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../rainerscript/functions/index.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../rainerscript/functions/idx_built-in_functions.html">Built-in Functions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Built-in Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-cnum.html">cnum()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-cstr.html">cstr()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-dyn_inc.html">dyn_inc()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-exec_template.html">exec_template()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-exists.html">exists()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-field.html">field()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-format_time.html">format_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-get_property.html">get_property()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-getenv.html">getenv()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-int2hex.html">int2hex()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-ipv4convert.html">num2ipv4() / ipv42num()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-is_time.html">is_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-lookup.html">lookup()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-parse_json.html">parse_json()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-parse_time.html">parse_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-percentile_observe.html">percentile_observe()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-previous_action_suspended.html">previous_action_suspended()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-prifilt.html">prifilt()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-random.html">random()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_extract.html">re_extract()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_extract_i.html">re_extract_i()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_match.html">re_match()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_match_i.html">re_match_i()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-replace.html">replace()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-script_error.html">script_error()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-strlen.html">strlen()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-substring.html">substring()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-tolower.html">tolower()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-trim.html">ltrim() / rtrim()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-wrap.html">wrap()</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../rainerscript/functions/idx_module_functions.html">Module Functions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Module Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-ffaup.html">Faup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-hashXX.html">HashXX</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-hashXXmod.html">HashXXmod</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-http_request.html">HTTP-Request</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-unflatten.html">Unflatten</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/control_structures.html">Control Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/configuration_objects.html">configuration objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/constant_strings.html">String Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/variable_property_types.html">Variable (Property) types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/lookup_tables.html">Lookup Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/queue_parameters.html">General Queue Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/rainerscript_call.html">The rsyslog “call” statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/rainerscript_call_indirect.html">The rsyslog “call_indirect” statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/global.html">global() configuration object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/include.html">The rsyslog include() object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/input.html">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/parser.html">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/timezone.html">timezone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/examples.html">Examples</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/index_directives.html">Legacy Configuration Directives</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Legacy Configuration Directives</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/config_param_types.html">Configuration Parameter Types</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/global/index.html">Legacy Global Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Legacy Global Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_abortonuncleanconfig.html">$AbortOnUncleanConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_debugprintcfsyslinehandlerlist.html">$DebugPrintCFSyslineHandlerList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_debugprintmodulelist.html">$DebugPrintModuleList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_debugprinttemplatelist.html">$DebugPrintTemplateList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_failonchownfailure.html">$FailOnChownFailure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_generateconfiggraph.html">$GenerateConfigGraph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_includeconfig.html">$IncludeConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_mainmsgqueuesize.html">$MainMsgQueueSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_maxopenfiles.html">$MaxOpenFiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_moddir.html">$ModDir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_modload.html">$ModLoad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_umask.html">$UMASK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_resetconfigvariables.html">$ResetConfigVariables</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/input_directives/index.html">Legacy Directives affecting Input Modules</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Legacy Directives affecting Input Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_allowedsender.html">$AllowedSender</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_dropmsgswithmaliciousdnsptrrecords.html">$DropMsgsWithMaliciousDnsPTRRecords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_controlcharacterescapeprefix.html">$ControlCharacterEscapePrefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_droptrailinglfonreception.html">$DropTrailingLFOnReception</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_escape8bitcharsonreceive.html">$Escape8BitCharactersOnReceive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_escapecontrolcharactersonreceive.html">$EscapeControlCharactersOnReceive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_markmessageperiod.html">$MarkMessagePeriod</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/action/index.html">Depricated Legacy Action-Specific Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Depricated Legacy Action-Specific Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_actionexeconlywhenpreviousissuspended.html">How to Convert Deprecated <cite>$ActionExecOnlyWhenPreviousIsSuspended</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_actionresumeinterval.html">How to Convert Deprecated <cite>$ActionResumeInterval</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_repeatedmsgreduction.html">$RepeatedMsgReduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_omfileforcechown.html">$omfileForceChown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_dirgroup.html">$DirGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_dirowner.html">How to Convert Deprecated <cite>$DirOwner</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_dynafilecachesize.html">$DynaFileCacheSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_filecreatemode.html">$FileCreateMode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_filegroup.html">$FileGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_fileowner.html">$FileOwner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_gssforwardservicename.html">$GssForwardServiceName</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_gssmode.html">$GssMode</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/ruleset/index.html">Ruleset-Specific Legacy Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Ruleset-Specific Legacy Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/ruleset/rsconf1_rulesetcreatemainqueue.html">$RulesetCreateMainQueue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/ruleset/rsconf1_rulesetparser.html">$RulesetParser</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/rsyslog_statistic_counter.html">rsyslog statistic counter</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/workflow.html">Where are the modules integrated into the Message Flow?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/output_channels.html">Output Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/droppriv.html">Dropping privileges in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/ipv6.html">Notes on IPv6 Handling in Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/cryprov_gcry.html">libgcrypt Log Crypto Provider (gcry)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/cryprov_ossl.html">libossl Log Crypto Provider (ossl)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/dyn_stats.html">Dynamic Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/lookup_tables.html">Lookup Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/percentile_stats.html">Percentile Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/converting_to_new_format.html">Converting older formats to <code class="docutils literal notranslate"><span class="pre">advanced</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/conf_formats.html">Configuration Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/sysklogd_format.html">sysklogd format</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../faq/index.html">FAQ</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of FAQ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/faq_overall.html">FAQ: some general topics often asked</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/difference_queues.html">What is the difference between the main_queue and a queue with a ruleset tied to an input?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/encrypt_mysql_traffic_ommysql.html">FAQ: Encrypting MySQL Traffic with ommysql Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/imudp-packet-loss.html">FAQ: Troubleshooting UDP Packet Loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/common-config-mistakes.html">Common Configuration Mistakes and Misunderstandings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/tls_cert_summary.html">Encrypting Syslog Traffic with TLS (SSL)</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Encrypting Syslog Traffic with TLS (SSL)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_scenario.html">Sample Use Case: Single Central Log Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_ca.html">Setting up the CA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_machine.html">Generating the machine certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_server.html">Setting up the Central Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_client.html">Setting up a client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_udp_relay.html">Setting up the UDP syslog relay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_errmsgs.html">Error Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_script.html">Creating certificates with a script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tls.html">Encrypting Syslog Traffic with TLS (SSL) [short version]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/database.html">Writing syslog messages to MariaDB, MySQL, PostgreSQL or any other supported Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/high_database_rate.html">Handling a massive syslog database insert rate with Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/reliable_forwarding.html">Reliable Forwarding of syslog Messages with Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/recording_pri.html">Recording the Priority of Syslog Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/failover_syslog_server.html">Failover Syslog Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/log_rotation_fix_size.html">Log rotation with rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/gelf_forwarding.html">GELF forwarding in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/log_sampling.html">Log Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/random_sampling.html">Random sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/hash_sampling.html">Hash-based Sampling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Troubleshooting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/file_not_written.html">Output File is not Being Written</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/selinux.html">Troubleshooting SELinux-Related Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/debug.html">Rsyslog Debug Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/troubleshoot.html">troubleshooting problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/howtodebug.html">How to create a debug log</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../concepts/index.html">Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/queues.html">Understanding rsyslog Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/janitor.html">The Janitor Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/messageparser.html">Message parsers in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/multi_ruleset.html">Multiple Rulesets in rsyslog</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../concepts/netstrm_drvr.html">NetStream Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of NetStream Drivers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_ptcp.html">ptcp Network Stream Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html">gtls Network Stream Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#supported-driver-modes">Supported Driver Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#supported-authentication-modes">Supported Authentication Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#checkextendedkeypurpose">CheckExtendedKeyPurpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#prioritizesan">PrioritizeSAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_ossl.html">openssl Network Stream Driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Development</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Development</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config_data_model.html">The rsyslog config data model</a></li>
<li class="toctree-l2"><a class="reference internal" href="config_data_model.html#objects">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_action_threads.html">Action Threads and Queue Engine (Developer-Oriented)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_codestyle.html">rsyslog code style</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Writing Rsyslog Output Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_queue.html">The rsyslog queue object</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_testbench.html">writing rsyslog tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="doc_reference_section_guidelines.html">Documentation Reference Section Structure Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="doc_style_guide.html">Documentation Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic_design.html">Generic design of a syslogd</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_tooling.html">Internal tooling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../idx_reference.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../containers/index.html">rsyslog and containers</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of rsyslog and containers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../containers/container_features.html">Container-Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../containers/docker_specifics.html">docker specifics</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../installation/index.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/packages.html">Installing rsyslog from Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/rsyslog_docker.html">Using Rsyslog Docker Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/install_from_source.html">Installing rsyslog from Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/build_from_repo.html">Installing rsyslog from the source repository</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../historical/index.html">Historical Documents</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Historical Documents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../historical/php_syslog_ng.html">Using php-syslog-ng with rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/multi_ruleset_legacy_format_samples.html">Legacy Format Samples for Multiple Rulesets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/module_devel.html">Developing rsyslog modules (outdated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/high_performance.html">Receiving massive amounts of messages with high performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v8compatibility.html">Compatibility Notes for rsyslog v8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v7compatibility.html">Compatibility Notes for rsyslog v7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v6compatibility.html">Compatibility Notes for rsyslog v6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v5compatibility.html">Compatibility Notes for rsyslog v5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v4compatibility.html">Compatibility Notes for rsyslog v4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v3compatibility.html">Compatibility Notes for rsyslog v3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../history.html">RSyslog - History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../licensing.html">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how2help.html">How you can Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community.html">Community Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html">RSyslog - Features</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../proposals/index.html">Proposals</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Proposals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../proposals/version_naming.html">Version Naming</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../whitepapers/index.html">Rsyslog Whitepapers</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Rsyslog Whitepapers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../whitepapers/syslog_parsing.html">syslog parsing in rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whitepapers/syslog_protocol.html">syslog-protocol support in rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whitepapers/queues_analogy.html">Turning Lanes and Rsyslog Queues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whitepapers/preserve_in_nat.html">Preserving syslog sender over NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../whitepapers/reliable_logging.html">How reliable should reliable logging be?</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/development/dev_oplugins.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="writing-rsyslog-output-plugins">
<h1>Writing Rsyslog Output Plugins<a class="headerlink" href="#writing-rsyslog-output-plugins" title="Link to this heading">¶</a></h1>
<p>This page is the begin of some developer documentation for writing
output plugins. Doing so is quite easy (and that was a design goal), but
there currently is only sparse documentation on the process available. I
was tempted NOT to write this guide here because I know I will most
probably not be able to write a complete guide.</p>
<p>However, I finally concluded that it may be better to have some
information and pointers than to have nothing.</p>
<section id="getting-started-and-samples">
<h2>Getting Started and Samples<a class="headerlink" href="#getting-started-and-samples" title="Link to this heading">¶</a></h2>
<p>The best to get started with rsyslog plugin development is by looking at
existing plugins. All that start with “om” are <strong>o</strong>utput
<strong>m</strong>odules. That means they are primarily thought of being message
sinks. In theory, however, output plugins may aggregate other
functionality, too. Nobody has taken this route so far so if you would
like to do that, it is highly suggested to post your plan on the rsyslog
mailing list, first (so that we can offer advice).</p>
<p>The rsyslog distribution tarball contains the omstdout plugin which is
extremely well targeted for getting started. Just note that this plugin
itself is not meant for production use. But it is very simplistic and so
a really good starting point to grasp the core ideas.</p>
<p>In any case, you should also read the comments in
./runtime/module-template.h. Output plugins are built based on a large
set of code-generating macros. These macros handle most of the plumbing
needed by the interface. As long as no special callback to rsyslog is
needed (it typically is not), an output plugin does not really need to
be aware that it is executed by rsyslog. As a plug-in programmer, you
can (in most cases) “code as usual”. However, all macros and entry
points need to be provided and thus reading the code comments in the
files mentioned is highly suggested.</p>
<p>For testing, you need rsyslog’s debugging support. Some useful
information is given in “<a class="reference external" href="troubleshoot.html">troubleshooting rsyslog</a>
from the doc set.</p>
</section>
<section id="special-topics">
<h2>Special Topics<a class="headerlink" href="#special-topics" title="Link to this heading">¶</a></h2>
<section id="threading">
<h3>Threading<a class="headerlink" href="#threading" title="Link to this heading">¶</a></h3>
<p>Rsyslog uses massive parallel processing and multithreading. However, a
plugin’s entry points are guaranteed to be never called concurrently
<strong>for the same action</strong>. That means your plugin must be able to be
called concurrently by two or more threads, but you can be sure that for
the same instance no concurrent calls happen. This is guaranteed by the
interface specification and the rsyslog core guards against multiple
concurrent calls. An instance, in simple words, is one that shares a
single instanceData structure.</p>
<p>So as long as you do not mess around with global data, you do not need
to think about multithreading (and can apply a purely sequential
programming methodology).</p>
<p>Please note that during the configuration parsing stage of execution,
access to global variables for the configuration system is safe. In that
stage, the core will only call sequentially into the plugin.</p>
</section>
<section id="getting-message-data">
<h3>Getting Message Data<a class="headerlink" href="#getting-message-data" title="Link to this heading">¶</a></h3>
<p>The doAction() entry point of your plugin is provided with messages to
be processed. It will only be activated after filtering and all other
conditions, so you do not need to apply any other conditional but can
simply process the message.</p>
<p>Note that you do NOT receive the full internal representation of the
message object. There are various (including historical) reasons for
this and, among others, this is a design decision based on security.</p>
<p>Your plugin will only receive what the end user has configured in a
$template statement. However, starting with 4.1.6, there are two ways of
receiving the template content. The default mode, and in most cases
sufficient and optimal, is to receive a single string with the expanded
template. As I said, this is usually optimal, think about writing things
to files, emailing content or forwarding it.</p>
<p>The important philosophy is that a plugin should <strong>never</strong> reformat any
of such strings - that would either remove the user’s ability to fully
control message formats or it would lead to duplicating code that is
already present in the core. If you need some formatting that is not yet
present in the core, suggest it to the rsyslog project, best done by
sending a patch ;), and we will try hard to get it into the core (so
far, we could accept all such suggestions - no promise, though).</p>
<p>If a single string seems not suitable for your application, the plugin
can also request access to the template components. The typical use case
seems to be databases, where you would like to access properties via
specific fields. With that mode, you receive a char ** array, where
each array element points to one field from the template (from left to
right). Fields start at array index 0 and a NULL pointer means you have
reached the end of the array (the typical Unix “poor man’s linked list
in an array” design). Note, however, that each of the individual
components is a string. It is not a date stamp, number or whatever, but
a string. This is because rsyslog processes strings (from a high-level
design look at it) and so this is the natural data type. Feel free to
convert to whatever you need, but keep in mind that malformed packets
may have lead to field contents you’d never expected…</p>
<p>If you like to use the array-based parameter passing method, think that
it is only available in rsyslog 4.1.6 and above. If you can accept that
your plugin will not be working with previous versions, you do not need
to handle pre 4.1.6 cases. However, it would be “nice” if you shut down
yourself in these cases - otherwise the older rsyslog core engine will
pass you a string where you expect the array of pointers, what most
probably results in a segfault. To check whether or not the core
supports the functionality, you can use this code sequence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>BEGINmodInit()
    rsRetVal localRet;
    rsRetVal (*pomsrGetSupportedTplOpts)(unsigned long *pOpts);
    unsigned long opts;
    int bArrayPassingSupported;     /* does core support template passing as an array? */
CODESTARTmodInit
    *ipIFVersProvided = CURR_MOD_IF_VERSION; /* we only support the current interface specification */
CODEmodInit_QueryRegCFSLineHdlr
    /* check if the rsyslog core supports parameter passing code */
    bArrayPassingSupported = 0;
    localRet = pHostQueryEtryPt((uchar*)&quot;OMSRgetSupportedTplOpts&quot;, &amp;pomsrGetSupportedTplOpts);
    if(localRet == RS_RET_OK) {
        /* found entry point, so let&#39;s see if core supports array passing */
        CHKiRet((*pomsrGetSupportedTplOpts)(&amp;opts));
        if(opts &amp; OMSR_TPL_AS_ARRAY)
            bArrayPassingSupported = 1;
    } else if(localRet != RS_RET_ENTRY_POINT_NOT_FOUND) {
        ABORT_FINALIZE(localRet); /* Something else went wrong, what is not acceptable */
    }
    DBGPRINTF(&quot;omstdout: array-passing is %ssupported by rsyslog core.\n&quot;, bArrayPassingSupported ? &quot;&quot; : &quot;not &quot;);

    if(!bArrayPassingSupported) {
        DBGPRINTF(&quot;rsyslog core too old, shutting down this plug-in\n&quot;);
        ABORT_FINALIZE(RS_RET_ERR);
    }
</pre></div>
</div>
<p>The code first checks if the core supports the OMSRgetSupportedTplOpts()
API (which is also not present in all versions!) and, if so, queries the
core if the OMSR_TPL_AS_ARRAY mode is supported. If either does not
exits, the core is too old for this functionality. The sample snippet
above then shuts down, but a plugin may instead just do things
different. In omstdout, you can see how a plugin may deal with the
situation.</p>
<p><strong>In any case, it is recommended that at least a graceful shutdown is
made and the array-passing capability not blindly be used.</strong> In such
cases, we can not guard the plugin from segfaulting and if the plugin
(as currently always) is run within rsyslog’s process space, that
results in a segfault for rsyslog. So do not do this.</p>
<p>Another possible mode is OMSR_TPL_AS_JSON, where instead of the
template a json-c memory object tree is passed to the module. The module
can extract data via json-c API calls. It MUST NOT modify the provided
structure. This mode is primarily aimed at plugins that need to process
tree-like data, as found for example in MongoDB or ElasticSearch.</p>
</section>
<section id="batching-of-messages">
<h3>Batching of Messages<a class="headerlink" href="#batching-of-messages" title="Link to this heading">¶</a></h3>
<p>Starting with rsyslog 4.3.x, batching of output messages is supported.
Previously, only a single-message interface was supported.</p>
<p>With the <strong>single message</strong> plugin interface, each message is passed via
a separate call to the plugin. Most importantly, the rsyslog engine
assumes that each call to the plugin is a complete transaction and as
such assumes that messages be properly committed after the plugin returns
to the engine.</p>
<p>With the <strong>batching</strong> interface, rsyslog employs something along the
line of “transactions”. Obviously, the rsyslog core can not make
non-transactional outputs to be fully transactional. But what it can is
support that the output tells the core which messages have been committed
by the output and which not yet. The core can than take care of those
uncommitted messages when problems occur. For example, if a plugin has
received 50 messages but not yet told the core that it committed them,
and then returns an error state, the core assumes that all these 50
messages were <strong>not</strong> written to the output. The core then requeues all
50 messages and does the usual retry processing. Once the output plugin
tells the core that it is ready again to accept messages, the rsyslog
core will provide it with these 50 not yet committed messages again
(actually, at this point, the rsyslog core no longer knows that it is
re-submitting the messages). If, in contrary, the plugin had told rsyslog
that 40 of these 50 messages were committed (before it failed), then only
10 would have been requeued and resubmitted.</p>
<p>In order to provide an efficient implementation, there are some (mild)
constraints in that transactional model: first of all, rsyslog itself
specifies the ultimate transaction boundaries. That is, it tells the
plugin when a transaction begins and when it must finish. The plugin is
free to commit messages in between, but it <strong>must</strong> commit all work done
when the core tells it that the transaction ends. All messages passed in
between a begin and end transaction notification are called a batch of
messages. They are passed in one by one, just as without transaction
support. Note that batch sizes are variable within the range of 1 to a
user configured maximum limit. Most importantly, that means that plugins
may receive batches of single messages, so they are required to commit
each message individually. If the plugin tries to be “smarter” than the
rsyslog engine and does not commit messages in those cases (for
example), the plugin puts message stream integrity at risk: once rsyslog
has notified the plugin of transaction end, it discards all messages as
it considers them committed and save. If now something goes wrong, the
rsyslog core does not try to recover lost messages (and keep in mind
that “goes wrong” includes such uncontrollable things like connection
loss to a database server). So it is highly recommended to fully abide
to the plugin interface details, even though you may think you can do it
better. The second reason for that is that the core engine will have
configuration settings that enable the user to tune commit rate to their
use-case specific needs. And, as a relief: why would rsyslog ever decide
to use batches of one? There is a trivial case and that is when we have
very low activity so that no queue of messages builds up, in which case
it makes sense to commit work as it arrives. (As a side-note, there are
some valid cases where a timeout-based commit feature makes sense. This
is also under evaluation and, once decided, the core will offer an
interface plus a way to preserve message stream integrity for
properly-crafted plugins).</p>
<p>The second restriction is that if a plugin makes commits in between
(what is perfectly legal) those commits must be in-order. So if a commit
is made for message ten out of 50, this means that messages one to nine
are also committed. It would be possible to remove this restriction, but
we have decided to deliberately introduce it to simplify things.</p>
</section>
<section id="output-plugin-transaction-interface">
<h3>Output Plugin Transaction Interface<a class="headerlink" href="#output-plugin-transaction-interface" title="Link to this heading">¶</a></h3>
<p>In order to keep compatible with existing output plugins (and because it
introduces no complexity), the transactional plugin interface is build
on the traditional non-transactional one. Well… actually the
traditional interface was transactional since its introduction, in the
sense that each message was processed in its own transaction.</p>
<p>So the current
<code class="docutils literal notranslate"><span class="pre">doAction()</span> <span class="pre">entry</span> <span class="pre">point</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">considered</span> <span class="pre">to</span> <span class="pre">have</span> <span class="pre">this</span> <span class="pre">structure</span> <span class="pre">(from</span> <span class="pre">the</span> <span class="pre">transactional</span> <span class="pre">interface</span> <span class="pre">point</span> <span class="pre">of</span> <span class="pre">view):</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">doAction</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="n">beginTransaction</span><span class="p">()</span>
    <span class="n">ProcessMessage</span><span class="p">()</span>
    <span class="n">endTransaction</span><span class="p">()</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>For the <strong>transactional interface</strong>, we now move these implicit
<code class="docutils literal notranslate"><span class="pre">beginTransaction()</span></code> and <code class="docutils literal notranslate"><span class="pre">endTransaction(()</span></code> call out of the message
processing body, resulting is such a structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">beginTransaction</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="o">/*</span> <span class="n">prepare</span> <span class="k">for</span> <span class="n">transaction</span> <span class="o">*/</span>
    <span class="p">}</span>

<span class="n">doAction</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="n">ProcessMessage</span><span class="p">()</span>
    <span class="o">/*</span> <span class="n">maybe</span> <span class="n">do</span> <span class="n">partial</span> <span class="n">commits</span> <span class="o">*/</span>
    <span class="p">}</span>

<span class="n">endTransaction</span><span class="p">()</span>
    <span class="p">{</span>
    <span class="o">/*</span> <span class="n">commit</span> <span class="p">(</span><span class="n">rest</span> <span class="n">of</span><span class="p">)</span> <span class="n">batch</span> <span class="o">*/</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>And this calling structure actually is the transactional interface! It
is as simple as this. For the new interface, the core calls a
<code class="docutils literal notranslate"><span class="pre">beginTransaction()</span></code> entry point inside the plugin at the start of the
batch. Similarly, the core call <code class="docutils literal notranslate"><span class="pre">endTransaction()</span></code> at the end of the
batch. The plugin must implement these entry points according to its
needs.</p>
<p>But how does the core know when to use the old or the new calling
interface? This is rather easy: when loading a plugin, the core queries
the plugin for the <code class="docutils literal notranslate"><span class="pre">beginTransaction()</span></code> and <code class="docutils literal notranslate"><span class="pre">endTransaction()</span></code> entry
points. If the plugin supports these, the new interface is used. If the
plugin does not support them, the old interface is used and rsyslog
implies that a commit is done after each message. Note that there is no
special “downlevel” handling necessary to support this. In the case of
the non-transactional interface, rsyslog considers each completed call
to <code class="docutils literal notranslate"><span class="pre">doAction</span></code> as partial commit up to the current message. So
implementation inside the core is very straightforward.</p>
<p>Actually, <strong>we recommend that the transactional entry points only be
defined by those plugins that actually need them</strong>. All others should
not define them in which case the default commit behaviour inside
rsyslog will apply (thus removing complexity from the plugin).</p>
<p>In order to support partial commits, special return codes must be
defined for <code class="docutils literal notranslate"><span class="pre">doAction</span></code>. All those return codes mean that processing
completed successfully. But they convey additional information about the
commit status as follows:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><em>RS_RET_OK</em></p></td>
<td><p>The record and all previous inside the batch has been committed. <em>Note:</em> this definition is what makes integrating plugins without the transaction being/end calls so easy - this is the traditional “success” return state and if every call returns it, there is no need for actually calling <code class="docutils literal notranslate"><span class="pre">endTransaction()</span></code>, because there is no transaction open).</p></td>
</tr>
<tr class="row-even"><td><p><em>RS_RET_DEFER_COMMIT</em></p></td>
<td><p>The record has been processed, but is not yet committed. This is the expected state for transactional-aware plugins.</p></td>
</tr>
<tr class="row-odd"><td><p><em>RS_RET_PREVIOUS_COMMITTED</em></p></td>
<td><p>The <strong>previous</strong> record inside the batch has been committed, but the current one not yet. This state is introduced to support sources that fill up buffers and commit once a buffer is completely filled. That may occur halfway in the next record, so it may be important to be able to tell the engine the everything up to the previous record is committed</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that the typical <strong>calling cycle</strong> is <code class="docutils literal notranslate"><span class="pre">beginTransaction()</span></code>,
followed by <em>n</em> times <code class="docutils literal notranslate"><span class="pre">doAction()</span></code> followed by <code class="docutils literal notranslate"><span class="pre">endTransaction()</span></code>.
However, if either <code class="docutils literal notranslate"><span class="pre">beginTransaction()</span></code> or <code class="docutils literal notranslate"><span class="pre">doAction()</span></code> return back
an error state (including RS_RET_SUSPENDED), then the transaction is
considered aborted. In result, the remaining calls in this cycle (e.g.
<code class="docutils literal notranslate"><span class="pre">endTransaction()</span></code>) are never made and a new cycle (starting with
<code class="docutils literal notranslate"><span class="pre">beginTransaction()</span></code> is begun when processing resumes. So an output
plugin must expect and handle those partial cycles gracefully.</p>
<p><strong>The question remains how can a plugin know if the core supports
batching?</strong> First of all, even if the engine would not know it, the
plugin would return with RS_RET_DEFER_COMMIT, what then would be
treated as an error by the engine. This would effectively disable the
output, but cause no further harm (but may be harm enough in itself).</p>
<p>The real solution is to enable the plugin to query the rsyslog core if
this feature is supported or not. At the time of the introduction of
batching, no such query-interface exists. So we introduce it with that
release. What the means is if a rsyslog core can not provide this query
interface, it is a core that was build before batching support was
available. So the absence of a query interface indicates that the
transactional interface is not available. One might now be tempted to
think there is no need to do the actual check, but it is recommended to
ask the rsyslog engine explicitly if the transactional interface is
present and will be honored. This enables us to create versions in the
future which have, for whatever reason we do not yet know, no support
for this interface.</p>
<p>The logic to do these checks is contained in the <code class="docutils literal notranslate"><span class="pre">INITChkCoreFeature</span></code>
macro, which can be used as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INITChkCoreFeature</span><span class="p">(</span><span class="n">bCoreSupportsBatching</span><span class="p">,</span> <span class="n">CORE_FEATURE_BATCHING</span><span class="p">);</span>
</pre></div>
</div>
<p>Here, bCoreSupportsBatching is a plugin-defined integer which after
execution is 1 if batches (and thus the transactional interface) is
supported and 0 otherwise. CORE_FEATURE_BATCHING is the feature we are
interested in. Future versions of rsyslog may contain additional
feature-test-macros (you can see all of them in ./runtime/rsyslog.h).</p>
<p>Note that the ompsql output plugin supports transactional mode in a
hybrid way and thus can be considered good example code.</p>
</section>
</section>
<section id="open-issues">
<h2>Open Issues<a class="headerlink" href="#open-issues" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Processing errors handling</p></li>
<li><p>reliable re-queue during error handling and queue termination</p></li>
</ul>
<section id="licensing">
<h3>Licensing<a class="headerlink" href="#licensing" title="Link to this heading">¶</a></h3>
<p>From the rsyslog point of view, plugins constitute separate projects. As
such, we think plugins are not required to be compatible with GPLv3.
However, this is not legal advise. If you intend to release something
under a non-GPLV3 compatible license it is probably best to consult with
your lawyer.</p>
<p>Most importantly, and this is definite, the rsyslog team does not expect
or require you to contribute your plugin to the rsyslog project (but of
course we are happy if you do).</p>
<hr class="docutils" />
<p><strong>Support:</strong> <a class="reference external" href="https://rsyslog.ai">rsyslog Assistant</a> |
<a class="reference external" href="https://github.com/rsyslog/rsyslog/discussions">GitHub Discussions</a> |
GitHub Issues: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a></p>
<p><strong>Contributing:</strong> Source &amp; docs: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a></p>
<p>© 2008–2025 <a class="reference external" href="https://rainer.gerhards.net/">Rainer Gerhards</a>
and others. Licensed under the <a class="reference external" href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="dev_queue.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">The rsyslog queue object</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="dev_codestyle.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">rsyslog code style</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Writing Rsyslog Output Plugins</a><ul>
<li><a class="reference internal" href="#getting-started-and-samples">Getting Started and Samples</a></li>
<li><a class="reference internal" href="#special-topics">Special Topics</a><ul>
<li><a class="reference internal" href="#threading">Threading</a></li>
<li><a class="reference internal" href="#getting-message-data">Getting Message Data</a></li>
<li><a class="reference internal" href="#batching-of-messages">Batching of Messages</a></li>
<li><a class="reference internal" href="#output-plugin-transaction-interface">Output Plugin Transaction Interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#open-issues">Open Issues</a><ul>
<li><a class="reference internal" href="#licensing">Licensing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=6fd4f6cc"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>