<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="imtuxedoulog: Tuxedo ULOG input module" href="imtuxedoulog.html" /><link rel="prev" title="imsolaris: Solaris Input Module" href="imsolaris.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>imtcp: TCP Syslog Input Module - rsyslog 8.2508 daily stable documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../../_static/rsyslog.css?v=6406a7f4" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">rsyslog 8.2508 daily stable documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <span class="sidebar-brand-text">rsyslog 8.2508 daily stable documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../about/index.html">About rsyslog</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of About rsyslog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/ai_first.html">AI-First: Our Vision for rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/history.html">History and Future of rsyslog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../getting_started/index.html">Getting Started with rsyslog</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Getting Started with rsyslog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html">Installing rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/basic_configuration.html">Basic Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/understanding_default_config.html">Understanding the Default Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/forwarding_logs.html">Forwarding Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/next_steps.html">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Configuration</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Configuration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../basic_structure.html">Basic Structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="idx_output.html">Output Modules</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Output Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="omamqp1.html">omamqp1: AMQP 1.0 Messaging Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omazureeventhubs.html">omazureeventhubs: Microsoft Azure Event Hubs Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omclickhouse.html">omclickhouse: ClickHouse Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omczmq.html">omczmq: Output module for ZeroMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="omdtls.html">omdtls: Output Module for DTLS Protocol over UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="omelasticsearch.html">omelasticsearch: Elasticsearch Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omfile.html">omfile: File Output Module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="omfwd.html">omfwd: syslog Forwarding Output Module</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of omfwd: syslog Forwarding Output Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="omfwd/parameters/basic.html">Basic Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="omfwd/parameters/module.html">Module Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="omhdfs.html">omhdfs: Hadoop Filesystem Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omhiredis.html">omhiredis: Redis Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omhttp.html">omhttp: HTTP Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omhttpfs.html">omhttpfs: Hadoop HTTPFS Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omjournal.html">omjournal: Systemd Journal Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="omkafka.html">omkafka: write to Apache Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="omlibdbi.html">omlibdbi: Generic Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ommail.html">ommail: Mail Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ommongodb.html">ommongodb: MongoDB Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ommysql.html">ommysql: MariaDB/MySQL Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omoracle.html">omoracle: Oracle Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="ompgsql.html">PostgreSQL Database Output Module (ompgsql)</a></li>
<li class="toctree-l3"><a class="reference internal" href="ompipe.html">ompipe: Pipe Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omprog.html">omprog: Program integration Output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omrabbitmq.html">omrabbitmq: RabbitMQ output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omrelp.html">omrelp: RELP Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omruleset.html">omruleset: ruleset output/including module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsendertrack.html">omsendertrack: Sender Tracking Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omsnmp.html">omsnmp: SNMP Trap Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omstdout.html">omstdout: stdout output module (testbench tool)</a></li>
<li class="toctree-l3"><a class="reference internal" href="omudpspoof.html">omudpspoof: UDP spoofing output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="omusrmsg.html">omusrmsg: notify users</a></li>
<li class="toctree-l3"><a class="reference internal" href="omuxsock.html">omuxsock: Unix sockets Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="sigprov_gt.html">GuardTime Log Signature Provider (gt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sigprov_ksi.html">Keyless Signature Infrastructure Provider (ksi)</a></li>
<li class="toctree-l3"><a class="reference internal" href="sigprov_ksi12.html">KSI Signature Provider (rsyslog-ksi-ls12)</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="idx_input.html">Input Modules</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Input Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="im3195.html">im3195: RFC3195 Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imbatchreport.html">imbatchreport: Batch report input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imczmq.html">imczmq: Input module for ZeroMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="imdocker.html">imdocker: Docker Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imdtls.html">imdtls: Input Module for DTLS Protocol over UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="imfile.html">imfile: Text File Input Module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="imgssapi.html">imgssapi: GSSAPI Syslog Input Module</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of imgssapi: GSSAPI Syslog Input Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="gssapi.html">GSSAPI module support in rsyslog v3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="imhiredis.html">Imhiredis: Redis input plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="imhttp.html">imhttp: HTTP input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imjournal.html">imjournal: Systemd Journal Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imkafka.html">imkafka: read from Apache Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="imklog.html">imklog: Kernel Log Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imkmsg.html">imkmsg: /dev/kmsg Log Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="immark.html">immark: Mark Message Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="impcap.html">Impcap: network traffic capture</a></li>
<li class="toctree-l3"><a class="reference internal" href="improg.html">improg: Program integration input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="impstats.html">impstats: Generate Periodic Statistics of Internal Counters</a></li>
<li class="toctree-l3"><a class="reference internal" href="imptcp.html">imptcp: Plain TCP Syslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="imrelp.html">imrelp: RELP Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imsolaris.html">imsolaris: Solaris Input Module</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">imtcp: TCP Syslog Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imtuxedoulog.html">imtuxedoulog: Tuxedo ULOG input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imudp.html">imudp: UDP Syslog Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="imuxsock.html">imuxsock: Unix Socket Input Module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="idx_parser.html">Parser Modules</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parser Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="pmciscoios.html">pmciscoios</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmdb2diag.html">pmdb2diag: DB2 Diag file parser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmlastmsg.html">pmlastmsg: last message repeated n times</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmnormalize.html">Log Message Normalization Parser Module (pmnormalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmnull.html">pmnull: Syslog Null Parser Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmrfc3164.html">pmrfc3164: Parse RFC3164-formatted messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmrfc3164sd.html">pmrfc3164sd: Parse RFC5424 structured data inside RFC3164 messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="pmrfc5424.html">pmrfc5424: Parse RFC5424-formatted messages</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="idx_messagemod.html">Message Modification Modules</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Message Modification Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="mmaitag.html">AI-based classification (mmaitag)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmanon.html">IP Address Anonymization Module (mmanon)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmcount.html">mmcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmdarwin.html">Darwin connector (mmdarwin)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmdblookup.html">MaxMind/GeoIP DB lookup (mmdblookup)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmexternal.html">Support module for external message modification modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmfields.html">Fields Extraction Module (mmfields)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmjsonparse.html">JSON/CEE Structured Content Extraction Module (mmjsonparse)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmkubernetes.html">Kubernetes Metadata Module (mmkubernetes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmnormalize.html">Log Message Normalization Module (mmnormalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmpstrucdata.html">RFC5424 structured data parsing module (mmpstrucdata)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmrfc5424addhmac.html">mmrfc5424addhmac</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmrm1stspace.html">mmrm1stspace: First Space Modification Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmsequence.html">Number generator and counter module (mmsequence)</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmsnmptrapd.html">mmsnmptrapd message modification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtaghostname.html">mmtaghostname: message modification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mmutf8fix.html">Fix invalid UTF-8 Sequences (mmutf8fix)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="idx_stringgen.html">String Generator Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="idx_library.html">Library Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../templates.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../properties.html">rsyslog Properties</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../property_replacer.html">The Property Replacer</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of The Property Replacer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../nomatch.html">Property Replacer nomatch mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../filters.html">Filter Conditions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../rainerscript/index.html">RainerScript</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of RainerScript</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/data_types.html">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/expressions.html">Expressions</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../rainerscript/functions/index.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../rainerscript/functions/idx_built-in_functions.html">Built-in Functions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Built-in Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-cnum.html">cnum()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-cstr.html">cstr()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-dyn_inc.html">dyn_inc()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-exec_template.html">exec_template()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-exists.html">exists()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-field.html">field()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-format_time.html">format_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-get_property.html">get_property()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-getenv.html">getenv()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-int2hex.html">int2hex()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-ipv4convert.html">num2ipv4() / ipv42num()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-is_time.html">is_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-lookup.html">lookup()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-parse_json.html">parse_json()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-parse_time.html">parse_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-percentile_observe.html">percentile_observe()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-previous_action_suspended.html">previous_action_suspended()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-prifilt.html">prifilt()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-random.html">random()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-re_extract.html">re_extract()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-re_extract_i.html">re_extract_i()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-re_match.html">re_match()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-re_match_i.html">re_match_i()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-replace.html">replace()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-script_error.html">script_error()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-strlen.html">strlen()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-substring.html">substring()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-tolower.html">tolower()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-trim.html">ltrim() / rtrim()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/rs-wrap.html">wrap()</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../rainerscript/functions/idx_module_functions.html">Module Functions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Module Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/mo-ffaup.html">Faup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/mo-hashXX.html">HashXX</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/mo-hashXXmod.html">HashXXmod</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/mo-http_request.html">HTTP-Request</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../rainerscript/functions/mo-unflatten.html">Unflatten</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/control_structures.html">Control Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/configuration_objects.html">configuration objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/constant_strings.html">String Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/variable_property_types.html">Variable (Property) types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/lookup_tables.html">Lookup Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/queue_parameters.html">General Queue Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/rainerscript_call.html">The rsyslog “call” statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/rainerscript_call_indirect.html">The rsyslog “call_indirect” statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/global.html">global() configuration object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rainerscript/include.html">The rsyslog include() object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input.html">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parser.html">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timezone.html">timezone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_directives.html">Legacy Configuration Directives</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Legacy Configuration Directives</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../config_param_types.html">Configuration Parameter Types</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../global/index.html">Legacy Global Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Legacy Global Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_abortonuncleanconfig.html">$AbortOnUncleanConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_debugprintcfsyslinehandlerlist.html">$DebugPrintCFSyslineHandlerList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_debugprintmodulelist.html">$DebugPrintModuleList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_debugprinttemplatelist.html">$DebugPrintTemplateList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_failonchownfailure.html">$FailOnChownFailure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_generateconfiggraph.html">$GenerateConfigGraph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_includeconfig.html">$IncludeConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_mainmsgqueuesize.html">$MainMsgQueueSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_maxopenfiles.html">$MaxOpenFiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_moddir.html">$ModDir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_modload.html">$ModLoad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_umask.html">$UMASK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../global/options/rsconf1_resetconfigvariables.html">$ResetConfigVariables</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../input_directives/index.html">Legacy Directives affecting Input Modules</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Legacy Directives affecting Input Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_allowedsender.html">$AllowedSender</a></li>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_dropmsgswithmaliciousdnsptrrecords.html">$DropMsgsWithMaliciousDnsPTRRecords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_controlcharacterescapeprefix.html">$ControlCharacterEscapePrefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_droptrailinglfonreception.html">$DropTrailingLFOnReception</a></li>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_escape8bitcharsonreceive.html">$Escape8BitCharactersOnReceive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_escapecontrolcharactersonreceive.html">$EscapeControlCharactersOnReceive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../input_directives/rsconf1_markmessageperiod.html">$MarkMessagePeriod</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../action/index.html">Depricated Legacy Action-Specific Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Depricated Legacy Action-Specific Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_actionexeconlywhenpreviousissuspended.html">How to Convert Deprecated <cite>$ActionExecOnlyWhenPreviousIsSuspended</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_actionresumeinterval.html">How to Convert Deprecated <cite>$ActionResumeInterval</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_repeatedmsgreduction.html">$RepeatedMsgReduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_omfileforcechown.html">$omfileForceChown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_dirgroup.html">$DirGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_dirowner.html">How to Convert Deprecated <cite>$DirOwner</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_dynafilecachesize.html">$DynaFileCacheSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_filecreatemode.html">$FileCreateMode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_filegroup.html">$FileGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_fileowner.html">$FileOwner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_gssforwardservicename.html">$GssForwardServiceName</a></li>
<li class="toctree-l4"><a class="reference internal" href="../action/rsconf1_gssmode.html">$GssMode</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ruleset/index.html">Ruleset-Specific Legacy Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Ruleset-Specific Legacy Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ruleset/rsconf1_rulesetcreatemainqueue.html">$RulesetCreateMainQueue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ruleset/rsconf1_rulesetparser.html">$RulesetParser</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rsyslog_statistic_counter.html">rsyslog statistic counter</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="workflow.html">Where are the modules integrated into the Message Flow?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../output_channels.html">Output Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../droppriv.html">Dropping privileges in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipv6.html">Notes on IPv6 Handling in Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryprov_gcry.html">libgcrypt Log Crypto Provider (gcry)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryprov_ossl.html">libossl Log Crypto Provider (ossl)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dyn_stats.html">Dynamic Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lookup_tables.html">Lookup Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../percentile_stats.html">Percentile Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../converting_to_new_format.html">Converting older formats to <code class="docutils literal notranslate"><span class="pre">advanced</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../conf_formats.html">Configuration Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sysklogd_format.html">sysklogd format</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../faq/index.html">FAQ</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of FAQ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq/faq_overall.html">FAQ: some general topics often asked</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/difference_queues.html">What is the difference between the main_queue and a queue with a ruleset tied to an input?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/encrypt_mysql_traffic_ommysql.html">FAQ: Encrypting MySQL Traffic with ommysql Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/imudp-packet-loss.html">FAQ: Troubleshooting UDP Packet Loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/common-config-mistakes.html">Common Configuration Mistakes and Misunderstandings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorials/tls_cert_summary.html">Encrypting Syslog Traffic with TLS (SSL)</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Encrypting Syslog Traffic with TLS (SSL)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_scenario.html">Sample Use Case: Single Central Log Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_ca.html">Setting up the CA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_machine.html">Generating the machine certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_server.html">Setting up the Central Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_client.html">Setting up a client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_udp_relay.html">Setting up the UDP syslog relay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_errmsgs.html">Error Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorials/tls_cert_script.html">Creating certificates with a script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/tls.html">Encrypting Syslog Traffic with TLS (SSL) [short version]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/database.html">Writing syslog messages to MariaDB, MySQL, PostgreSQL or any other supported Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/high_database_rate.html">Handling a massive syslog database insert rate with Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/reliable_forwarding.html">Reliable Forwarding of syslog Messages with Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/recording_pri.html">Recording the Priority of Syslog Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/failover_syslog_server.html">Failover Syslog Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/log_rotation_fix_size.html">Log rotation with rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/gelf_forwarding.html">GELF forwarding in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/log_sampling.html">Log Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/random_sampling.html">Random sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/hash_sampling.html">Hash-based Sampling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Troubleshooting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/file_not_written.html">Output File is not Being Written</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/selinux.html">Troubleshooting SELinux-Related Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/debug.html">Rsyslog Debug Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot.html">troubleshooting problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/howtodebug.html">How to create a debug log</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../concepts/index.html">Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/queues.html">Understanding rsyslog Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/janitor.html">The Janitor Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/messageparser.html">Message parsers in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/multi_ruleset.html">Multiple Rulesets in rsyslog</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../concepts/netstrm_drvr.html">NetStream Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of NetStream Drivers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_ptcp.html">ptcp Network Stream Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_gtls.html">gtls Network Stream Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_gtls.html#supported-driver-modes">Supported Driver Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_gtls.html#supported-authentication-modes">Supported Authentication Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_gtls.html#checkextendedkeypurpose">CheckExtendedKeyPurpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_gtls.html#prioritizesan">PrioritizeSAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../concepts/ns_ossl.html">openssl Network Stream Driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/index.html">Development</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Development</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/config_data_model.html">The rsyslog config data model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/config_data_model.html#objects">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/dev_action_threads.html">Action Threads and Queue Engine (Developer-Oriented)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/dev_codestyle.html">rsyslog code style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/dev_oplugins.html">Writing Rsyslog Output Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/dev_queue.html">The rsyslog queue object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/dev_testbench.html">writing rsyslog tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/doc_reference_section_guidelines.html">Documentation Reference Section Structure Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/doc_style_guide.html">Documentation Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/generic_design.html">Generic design of a syslogd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/internal_tooling.html">Internal tooling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../idx_reference.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../containers/index.html">rsyslog and containers</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of rsyslog and containers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../containers/container_features.html">Container-Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../containers/docker_specifics.html">docker specifics</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../installation/index.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../installation/packages.html">Installing rsyslog from Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation/rsyslog_docker.html">Using Rsyslog Docker Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation/install_from_source.html">Installing rsyslog from Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../installation/build_from_repo.html">Installing rsyslog from the source repository</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../historical/index.html">Historical Documents</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Historical Documents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../historical/php_syslog_ng.html">Using php-syslog-ng with rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/multi_ruleset_legacy_format_samples.html">Legacy Format Samples for Multiple Rulesets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/module_devel.html">Developing rsyslog modules (outdated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/high_performance.html">Receiving massive amounts of messages with high performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/v8compatibility.html">Compatibility Notes for rsyslog v8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/v7compatibility.html">Compatibility Notes for rsyslog v7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/v6compatibility.html">Compatibility Notes for rsyslog v6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/v5compatibility.html">Compatibility Notes for rsyslog v5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/v4compatibility.html">Compatibility Notes for rsyslog v4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../historical/v3compatibility.html">Compatibility Notes for rsyslog v3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../history.html">RSyslog - History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../licensing.html">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../how2help.html">How you can Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community.html">Community Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../features.html">RSyslog - Features</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../proposals/index.html">Proposals</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Proposals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../proposals/version_naming.html">Version Naming</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../whitepapers/index.html">Rsyslog Whitepapers</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Rsyslog Whitepapers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/syslog_parsing.html">syslog parsing in rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/syslog_protocol.html">syslog-protocol support in rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/queues_analogy.html">Turning Lanes and Rsyslog Queues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/preserve_in_nat.html">Preserving syslog sender over NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../whitepapers/reliable_logging.html">How reliable should reliable logging be?</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/configuration/modules/imtcp.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="imtcp-tcp-syslog-input-module">
<h1>imtcp: TCP Syslog Input Module<a class="headerlink" href="#imtcp-tcp-syslog-input-module" title="Link to this heading">¶</a></h1>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Module Name:</strong></p></td>
<td><p><strong>imtcp</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>Author:</strong></p></td>
<td><p><a class="reference external" href="https://rainer.gerhards.net/">Rainer Gerhards</a> &lt;<a class="reference external" href="mailto:rgerhards&#37;&#52;&#48;adiscon&#46;com">rgerhards<span>&#64;</span>adiscon<span>&#46;</span>com</a>&gt;</p></td>
</tr>
</tbody>
</table>
</div>
<section id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Link to this heading">¶</a></h2>
<p>Provides the ability to receive syslog messages via TCP. Encryption is
natively provided by selecting the appropriate network stream driver
and can also be provided by using <a class="reference external" href="rsyslog_stunnel.html">stunnel</a> (an
alternative is the use the <a class="reference external" href="imgssapi.html">imgssapi</a> module).</p>
</section>
<section id="notable-features">
<h2>Notable Features<a class="headerlink" href="#notable-features" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#imtcp-statistic-counter"><span class="std std-ref">Statistic Counter</span></a></p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> module runs on all platforms but is <strong>optimized for Linux</strong> and other systems that
support <strong>epoll in edge-triggered mode</strong>. While earlier versions of imtcp operated exclusively
in <strong>single-threaded</strong> mode, starting with <strong>version 8.2504.0</strong>, a <strong>worker pool</strong> is used on
<strong>epoll-enabled systems</strong>, significantly improving performance.</p>
<p>The <strong>number of worker threads</strong> can be configured to match system requirements.</p>
<section id="starvation-protection">
<h3>Starvation Protection<a class="headerlink" href="#starvation-protection" title="Link to this heading">¶</a></h3>
<p>A common issue in high-volume logging environments is <strong>starvation</strong>, where a few high-traffic
sources overwhelm the system. Without protection, a worker may become stuck processing a single
connection continuously, preventing other clients from being served.</p>
<p>For example, if two worker threads are available and one machine floods the system with data,
<strong>only one worker remains</strong> to handle all other connections. If multiple sources send large
amounts of data, <strong>all workers could become monopolized</strong>, preventing other connections from
being processed.</p>
<p>To mitigate this, <strong>imtcp allows limiting the number of consecutive requests a worker can handle
per session</strong>. Once the limit is reached, the worker temporarily stops processing that session
and switches to other active connections. This ensures <strong>fair resource distribution</strong> while
preventing any single sender from <strong>monopolizing rsyslog’s processing power</strong>.</p>
<p>Even in <strong>single-threaded mode</strong>, a high-volume sender may consume significant resources, but it
will no longer block all other connections.</p>
</section>
<section id="configurable-behavior">
<h3>Configurable Behavior<a class="headerlink" href="#configurable-behavior" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The <strong>maximum number of requests per session</strong> before switching to another connection can be
adjusted.</p></li>
<li><p>In <strong>epoll mode</strong>, the <strong>number of worker threads</strong> can also be configured. More workers
provide better protection against single senders dominating processing.</p></li>
</ul>
</section>
<section id="monitoring-and-performance-insights">
<h3>Monitoring and Performance Insights<a class="headerlink" href="#monitoring-and-performance-insights" title="Link to this heading">¶</a></h3>
<p><strong>Statistics counters</strong> provide insights into key metrics, including starvation prevention.
These counters are <strong>critical for monitoring system health</strong>, especially in <strong>high-volume
datacenter deployments</strong>.</p>
</section>
</section>
<section id="configuration-parameters">
<h2>Configuration Parameters<a class="headerlink" href="#configuration-parameters" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Parameter names are case-insensitive.</p>
</div>
<section id="module-parameters">
<h3>Module Parameters<a class="headerlink" href="#module-parameters" title="Link to this heading">¶</a></h3>
<section id="addtlframedelimiter">
<h4>AddtlFrameDelimiter<a class="headerlink" href="#addtlframedelimiter" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>-1</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerAddtlFrameDelimiter</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 4.3.1.</span></p>
</div>
<p>This directive permits to specify an additional frame delimiter for
Multiple receivers may be configured by specifying $InputTCPServerRun
multiple times.</p>
</section>
<section id="disablelfdelimiter">
<h4>DisableLFDelimiter<a class="headerlink" href="#disablelfdelimiter" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerDisableLFDelimiter</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Industry-standard plain text tcp syslog uses the LF to delimit
syslog frames. However, some users brought up the case that it may be
useful to define a different delimiter and totally disable LF as a
delimiter (the use case named were multi-line messages). This mode is
non-standard and will probably come with a lot of problems. However,
as there is need for it and it is relatively easy to support, we do
so. Be sure to turn this setting to “on” only if you exactly know
what you are doing. You may run into all sorts of troubles, so be
prepared to wrangle with that!</p>
</section>
<section id="maxframesize">
<h4>MaxFrameSize<a class="headerlink" href="#maxframesize" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>200000</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>When in octet counted mode, the frame size is given at the beginning
of the message. With this parameter the max size this frame can have
is specified and when the frame gets to large the mode is switched to
octet stuffing.
The max value this parameter can have was specified because otherwise
the integer could become negative and this would result in a
Segmentation Fault. (Max Value = 200000000)</p>
</section>
<section id="notifyonconnectionopen">
<h4>NotifyOnConnectionOpen<a class="headerlink" href="#notifyonconnectionopen" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Instructs imtcp to emit a message if the remote peer closes a
connection.</p>
</section>
<section id="id1">
<h4>NotifyOnConnectionOpen<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Instructs imtcp to emit a message if the remote peer opens a
connection.</p>
</section>
<section id="notifyonconnectionclose">
<h4>NotifyOnConnectionClose<a class="headerlink" href="#notifyonconnectionclose" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerNotifyOnConnectionClose</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Instructs imtcp to emit a message if the remote peer closes a
connection.</p>
</section>
<section id="keepalive">
<h4>KeepAlive<a class="headerlink" href="#keepalive" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerKeepAlive</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Enable or disable keep-alive packets at the tcp socket layer. The
default is to disable them.</p>
</section>
<section id="keepalive-probes">
<h4>KeepAlive.Probes<a class="headerlink" href="#keepalive-probes" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerKeepAlive_probes</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The number of unacknowledged probes to send before considering the
connection dead and notifying the application layer. The default, 0,
means that the operating system defaults are used. This has only
effect if keep-alive is enabled. The functionality may not be
available on all platforms.</p>
</section>
<section id="keepalive-time">
<h4>KeepAlive.Time<a class="headerlink" href="#keepalive-time" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerKeepAlive_time</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The interval between the last data packet sent (simple ACKs are not
considered data) and the first keepalive probe; after the connection
is marked to need keepalive, this counter is not used any further.
The default, 0, means that the operating system defaults are used.
This has only effect if keep-alive is enabled. The functionality may
not be available on all platforms.</p>
</section>
<section id="keepalive-interval">
<h4>KeepAlive.Interval<a class="headerlink" href="#keepalive-interval" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>The interval for keep alive packets.</p>
</section>
<section id="flowcontrol">
<h4>FlowControl<a class="headerlink" href="#flowcontrol" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>on</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPFlowControl</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>This setting specifies whether some message flow control shall be
exercised on the related TCP input. If set to on, messages are
handled as “light delayable”, which means the sender is throttled a
bit when the queue becomes near-full. This is done in order to
preserve some queue space for inputs that can not throttle (like
UDP), but it may have some undesired effect in some configurations.
Still, we consider this as a useful setting and thus it is the
default. To turn the handling off, simply configure that explicitly.</p>
</section>
<section id="maxlisteners">
<h4>MaxListeners<a class="headerlink" href="#maxlisteners" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>20</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPMaxListeners</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets the maximum number of listeners (server ports) supported.
This must be set before the first $InputTCPServerRun directive.</p>
</section>
<section id="maxsessions">
<h4>MaxSessions<a class="headerlink" href="#maxsessions" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>200</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPMaxSessions</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets the maximum number of sessions supported. This must be set
before the first $InputTCPServerRun directive.</p>
</section>
<section id="streamdriver-name">
<h4>StreamDriver.Name<a class="headerlink" href="#streamdriver-name" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Selects <a class="reference internal" href="../../concepts/netstrm_drvr.html"><span class="doc">network stream driver</span></a>
for all inputs using this module.</p>
</section>
<section id="workerthreads">
<h4>WorkerThreads<a class="headerlink" href="#workerthreads" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>2</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Introduced in version 8.2504.0.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">WorkerThreads</span></code> parameter defines the <strong>default number of worker threads</strong> for all <code class="docutils literal notranslate"><span class="pre">imtcp</span></code>
listeners. This setting applies only on <strong>epoll-enabled systems</strong>. If <code class="docutils literal notranslate"><span class="pre">epoll</span></code> is unavailable,
<code class="docutils literal notranslate"><span class="pre">imtcp</span></code> will always run in <strong>single-threaded mode</strong>, regardless of this setting.</p>
<p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">2</span></code>
<strong>Allowed values:</strong> <code class="docutils literal notranslate"><span class="pre">1</span></code> (single-threaded) to any reasonable number (should not exceed CPU cores).</p>
<p><strong>Behavior and Recommendations</strong></p>
<ul class="simple">
<li><p>If set to <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> operates in <strong>single-threaded mode</strong>, using the main event loop
for processing.</p></li>
<li><p>If set to <code class="docutils literal notranslate"><span class="pre">2</span></code> or more, a <strong>worker pool</strong> is created, allowing multiple connections to be
processed in parallel.</p></li>
<li><p>Setting this too high <strong>can degrade performance</strong> due to excessive thread switching.</p></li>
<li><p>A reasonable upper limit is <strong>the number of available CPU cores</strong>.</p></li>
</ul>
<p><strong>Scope and Overrides</strong>
- This is a <strong>module-level parameter</strong>, meaning it <strong>sets the default</strong> for all <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> listeners.
- Each listener instance can override this by setting the <code class="docutils literal notranslate"><span class="pre">workerthreads</span></code> <strong>listener parameter</strong>.</p>
<p><strong>Example Configuration</strong>
The following sets a default of <strong>4</strong> worker threads for all listeners, while overriding it to
<strong>8</strong> for a specific listener:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imtcp&quot; WorkerThreads=&quot;4&quot;)  # Default for all listeners

input(type=&quot;imtcp&quot; port=&quot;514&quot; workerthreads=&quot;8&quot;)  # Overrides default, using 8 workers
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">WorkerThreads</span></code> is not explicitly set, the default of <code class="docutils literal notranslate"><span class="pre">2</span></code> will be used.</p>
</section>
<section id="starvationprotection-maxreads">
<span id="imtcp-starvationprotection-maxreads"></span><h4>StarvationProtection.MaxReads<a class="headerlink" href="#starvationprotection-maxreads" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>500</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Introduced in version 8.2504.0.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StarvationProtection.MaxReads</span></code> parameter defines the <strong>maximum number of consecutive
requests</strong> a worker can process for a single connection before switching to another session.
This mechanism prevents any single sender from <strong>monopolizing imtcp’s processing capacity</strong>.</p>
<p><strong>Default value:</strong> <code class="docutils literal notranslate"><span class="pre">500</span></code></p>
<p><strong>Allowed values:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> → Disables starvation protection (a single sender may dominate worker time).</p></li>
<li><p>Any positive integer → Specifies the maximum number of consecutive reads before switching.</p></li>
</ul>
<p><strong>Behavior and Use Cases</strong></p>
<ul class="simple">
<li><p>When a connection continuously sends data, a worker will process it <strong>up to MaxReads times</strong>
before returning it to the processing queue.</p></li>
<li><p>This ensures that <strong>other active connections</strong> get a chance to be processed.</p></li>
<li><p>Particularly useful in <strong>high-volume environments</strong> where a few senders might otherwise
consume all resources.</p></li>
<li><p>In <strong>single-threaded mode</strong>, this still provides fairness but cannot fully prevent resource
exhaustion.</p></li>
</ul>
<p><strong>Scope and Overrides</strong></p>
<ul class="simple">
<li><p>This is a <strong>module-level parameter</strong>, meaning it <strong>sets the default</strong> for all <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> listeners.</p></li>
<li><p>Each listener instance can override this by setting the
<code class="docutils literal notranslate"><span class="pre">starvationProtection.maxReads</span></code> <strong>listener parameter</strong>.</p></li>
</ul>
<p><strong>Example Configuration</strong></p>
<p>The following sets a <strong>default of 300</strong> reads per session before switching to another connection,
while overriding it to <strong>1000</strong> for a specific listener:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imtcp&quot; StarvationProtection.MaxReads=&quot;300&quot;)  # Default for all listeners

input(type=&quot;imtcp&quot; port=&quot;514&quot; starvationProtection.MaxReads=&quot;1000&quot;)  # Overrides default
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">StarvationProtection.MaxReads</span></code> is not explicitly set, the default of <code class="docutils literal notranslate"><span class="pre">500</span></code> will be used.</p>
</section>
<section id="streamdriver-mode">
<h4>StreamDriver.Mode<a class="headerlink" href="#streamdriver-mode" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerStreamDriverMode</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets the driver mode for the currently selected
<a class="reference internal" href="../../concepts/netstrm_drvr.html"><span class="doc">network stream driver</span></a>.
&lt;number&gt; is driver specific.</p>
</section>
<section id="streamdriver-authmode">
<h4>StreamDriver.AuthMode<a class="headerlink" href="#streamdriver-authmode" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerStreamDriverAuthMode</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets stream driver authentication mode. Possible values and meaning
depend on the
<a class="reference internal" href="../../concepts/netstrm_drvr.html"><span class="doc">network stream driver</span></a>.
used.</p>
</section>
<section id="streamdriver-permitexpiredcerts">
<h4>StreamDriver.PermitExpiredCerts<a class="headerlink" href="#streamdriver-permitexpiredcerts" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>warn</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Controls how expired certificates will be handled when stream driver is in TLS mode.
It can have one of the following values:</p>
<ul class="simple">
<li><p>on = Expired certificates are allowed</p></li>
<li><p>off = Expired certificates are not allowed  (Default, changed from warn to off since Version 8.2012.0)</p></li>
<li><p>warn = Expired certificates are allowed but warning will be logged</p></li>
</ul>
</section>
<section id="streamdriver-checkextendedkeypurpose">
<h4>StreamDriver.CheckExtendedKeyPurpose<a class="headerlink" href="#streamdriver-checkextendedkeypurpose" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Whether to check also purpose value in extended fields part of certificate
for compatibility with rsyslog operation. (driver-specific)</p>
</section>
<section id="streamdriver-prioritizesan">
<h4>StreamDriver.PrioritizeSAN<a class="headerlink" href="#streamdriver-prioritizesan" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Whether to use stricter SAN/CN matching. (driver-specific)</p>
</section>
<section id="streamdriver-tlsverifydepth">
<h4>StreamDriver.TlsVerifyDepth<a class="headerlink" href="#streamdriver-tlsverifydepth" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>TLS library default</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Specifies the allowed maximum depth for the certificate chain verification.
Support added in v8.2001.0, supported by GTLS and OpenSSL driver.
If not set, the API default will be used.
For OpenSSL, the default is 100 - see the doc for more:
<a class="reference external" href="https://docs.openssl.org/1.1.1/man3/SSL_CTX_set_verify/">https://docs.openssl.org/1.1.1/man3/SSL_CTX_set_verify/</a>
For GnuTLS, the default is 5 - see the doc for more:
<a class="reference external" href="https://www.gnutls.org/manual/gnutls.html">https://www.gnutls.org/manual/gnutls.html</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GnuTLS driver sends all certificates contained in the file
specified via <code class="docutils literal notranslate"><span class="pre">StreamDriver.CertFile</span></code> (or
<code class="docutils literal notranslate"><span class="pre">$DefaultNetstreamDriverCertFile</span></code>) to connecting clients.  To
expose intermediate certificates, the file must contain the server
certificate first, followed by the intermediate certificates.
This capability was added in rsyslog version 8.36.0.</p>
</div>
</section>
<section id="permittedpeer">
<h4>PermittedPeer<a class="headerlink" href="#permittedpeer" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>array</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerStreamDriverPermittedPeer</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets permitted peer IDs. Only these peers are able to connect to
the listener. &lt;id-string&gt; semantics depend on the currently
selected AuthMode and
<a class="reference internal" href="../../concepts/netstrm_drvr.html"><span class="doc">network stream driver</span></a>.
PermittedPeer may not be set in anonymous modes. PermittedPeer may
be set either to a single peer or an array of peers either of type
IP or name, depending on the tls certificate.</p>
<p>Single peer:
PermittedPeer=”127.0.0.1”</p>
<p>Array of peers:
PermittedPeer=[“test1.example.net”,”10.1.2.3”,”test2.example.net”,”…”]</p>
</section>
<section id="discardtruncatedmsg">
<h4>DiscardTruncatedMsg<a class="headerlink" href="#discardtruncatedmsg" title="Link to this heading">¶</a></h4>
<p>Normally when a message is truncated in octet stuffing mode the part that
is cut off is processed as the next message. When this parameter is activated,
the part that is cut off after a truncation is discarded and not processed.</p>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>off</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="gnutlsprioritystring">
<h4>gnutlsPriorityString<a class="headerlink" href="#gnutlsprioritystring" title="Link to this heading">¶</a></h4>
<p>The “gnutls priority string” parameter in rsyslog offers enhanced
customization for secure communications, allowing detailed configuration
of TLS driver properties. This includes specifying handshake algorithms
and other settings for GnuTLS, as well as implementing OpenSSL
configuration commands. Initially developed for GnuTLS, the “gnutls
priority string” has evolved since version v8.1905.0 to also support
OpenSSL, broadening its application and utility in network security
configurations. This update signifies a key advancement in rsyslog’s
capabilities, making the “gnutls priority string” an essential
feature for advanced TLS configuration.</p>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.29.0.</span></p>
</div>
<p><strong>Configuring Driver-Specific Properties</strong></p>
<p>This configuration string is used to set properties specific to different drivers. Originally designed for the GnuTLS driver, it has been extended to support OpenSSL configuration commands from version v8.1905.0 onwards.</p>
<p><strong>GNUTLS Configuration</strong></p>
<p>In GNUTLS, this setting determines the handshake algorithms and options for the TLS session. It’s designed to allow user overrides of the library’s default settings. If you leave this parameter unset (NULL), the system will revert to the default settings. For more detailed information on priority strings in GNUTLS, you can refer to the GnuTLS Priority Strings Documentation available at [GnuTLS Website](<a class="reference external" href="https://gnutls.org/manual/html_node/Priority-Strings.html">https://gnutls.org/manual/html_node/Priority-Strings.html</a>).</p>
<p><strong>OpenSSL Configuration</strong></p>
<p>This feature is compatible with OpenSSL Version 1.0.2 and above. It enables the passing of configuration commands to the OpenSSL library. You can find a comprehensive list of commands and their acceptable values in the OpenSSL Documentation, accessible at [OpenSSL Documentation](<a class="reference external" href="https://docs.openssl.org/1.0.2/man3/SSL_CONF_cmd/">https://docs.openssl.org/1.0.2/man3/SSL_CONF_cmd/</a>).</p>
<p><strong>General Configuration Guidelines</strong></p>
<p>The configuration can be formatted as a single line or across multiple lines. Each command within the configuration is separated by a linefeed (<cite>n</cite>). To differentiate between a command and its corresponding value, use an equal sign (<cite>=</cite>). Below are some examples to guide you in formatting these commands.</p>
</section>
</section>
<section id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Link to this heading">¶</a></h3>
<p>This will allow all protocols except for SSLv2 and SSLv3:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gnutlsPriorityString=&quot;Protocol=ALL,-SSLv2,-SSLv3&quot;
</pre></div>
</div>
</section>
<section id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Link to this heading">¶</a></h3>
<p>This will allow all protocols except for SSLv2, SSLv3 and TLSv1.
It will also set the minimum protocol to TLSv1.2</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gnutlsPriorityString=&quot;Protocol=ALL,-SSLv2,-SSLv3,-TLSv1
MinProtocol=TLSv1.2&quot;
</pre></div>
</div>
<section id="preservecase">
<h4>PreserveCase<a class="headerlink" href="#preservecase" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>boolean</p></td>
<td><p>on</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.37.0.</span></p>
</div>
<p>This parameter is for controlling the case in fromhost.  If preservecase is set to “off”, the case in fromhost is not preserved.  E.g., ‘host1.example.org’ the message was received from ‘Host1.Example.Org’.  Default to “on” for the backward compatibility.</p>
</section>
</section>
<section id="input-parameters">
<h3>Input Parameters<a class="headerlink" href="#input-parameters" title="Link to this heading">¶</a></h3>
<section id="port">
<h4>Port<a class="headerlink" href="#port" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>yes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerRun</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Starts a TCP server on selected port. If port zero is selected, the OS automatically
assigns a free port. Use <cite>listenPortFileName</cite> in this case to obtain the information
of which port was assigned.</p>
</section>
<section id="listenportfilename">
<h4>ListenPortFileName<a class="headerlink" href="#listenportfilename" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>This parameter specifies a file name into which the port number this input listens
on is written. It is primarily intended for cases when <cite>port</cite> is set to 0 to let
the OS automatically assign a free port number.</p>
</section>
<section id="address">
<h4>Address<a class="headerlink" href="#address" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>On multi-homed machines, specifies to which local address the
listener should be bound.</p>
</section>
<section id="name">
<h4>Name<a class="headerlink" href="#name" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>imtcp</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerInputName</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets a name for the inputname property. If no name is set “imtcp” is
used by default. Setting a name is not strictly necessary, but can be
useful to apply filtering based on which input the message was
received from.</p>
</section>
<section id="ruleset">
<h4>Ruleset<a class="headerlink" href="#ruleset" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerBindRuleset</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Binds the listener to a specific <a class="reference internal" href="../../concepts/multi_ruleset.html"><span class="doc">ruleset</span></a>.</p>
</section>
<section id="supportoctetcountedframing">
<h4>SupportOctetCountedFraming<a class="headerlink" href="#supportoctetcountedframing" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>on</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerSupportOctetCountedFraming</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>If set to “on”, the legacy octed-counted framing (similar to RFC5425
framing) is activated. This should be left unchanged until you know
very well what you do. It may be useful to turn it off, if you know
this framing is not used and some senders emit multi-line messages
into the message stream.</p>
</section>
<section id="socketbacklog">
<h4>SocketBacklog<a class="headerlink" href="#socketbacklog" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>10% of configured connections</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Specifies the backlog parameter passed to the <cite>listen()</cite> system call. This parameter
defines the maximum length of the queue for pending connections, which includes
partially established connections (those in the SYN-ACK handshake phase) and fully
established connections waiting to be accepted by the application.</p>
<p><strong>Available starting with the 8.2502.0 series.</strong></p>
<p>For more details, refer to the <cite>listen(2)</cite> man page.</p>
<p>By default, the value is set to 10% of the configured connections
to accommodate modern workloads. It can
be adjusted to suit specific requirements, such as:</p>
<ul class="simple">
<li><p><strong>High rates of concurrent connection attempts</strong>: Increasing this value helps handle bursts of incoming connections without dropping them.</p></li>
<li><p><strong>Test environments with connection flooding</strong>: Larger values are recommended to prevent SYN queue overflow.</p></li>
<li><p><strong>Servers with low traffic</strong>: Lower values may be used to reduce memory usage.</p></li>
</ul>
<p>The effective backlog size is influenced by system-wide kernel settings, particularly <cite>net.core.somaxconn</cite> and <cite>net.ipv4.tcp_max_syn_backlog</cite>. The smaller value between this parameter and the kernel limits is used as the actual backlog.</p>
</section>
<section id="ratelimit-interval">
<h4>RateLimit.Interval<a class="headerlink" href="#ratelimit-interval" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>0</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Specifies the rate-limiting interval in seconds. Default value is 0,
which turns off rate limiting. Set it to a number of seconds (5
recommended) to activate rate-limiting.</p>
</section>
<section id="ratelimit-burst">
<h4>RateLimit.Burst<a class="headerlink" href="#ratelimit-burst" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>10000</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<p>Specifies the rate-limiting burst in number of messages. Default is
10,000.</p>
</section>
<section id="id2">
<h4>listenPortFileName<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.38.0.</span></p>
</div>
<p>With this parameter you can specify the name for a file. In this file the
port, imtcp is connected to, will be written.
This parameter was introduced because the testbench works with dynamic ports.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this parameter is set, 0 will be accepted as the port. Otherwise it
is automatically changed to port 514</p>
</div>
</section>
<section id="id3">
<h4>StreamDriver.Name<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id4">
<h4>StreamDriver.Mode<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerStreamDriverMode</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id5">
<h4>StreamDriver.AuthMode<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">$InputTCPServerStreamDriverAuthMode</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id6">
<h4>StreamDriver.PermitExpiredCerts<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id7">
<h4>StreamDriver.CheckExtendedKeyPurpose<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id8">
<h4>StreamDriver.PrioritizeSAN<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id9">
<h4>StreamDriver.TlsVerifyDepth<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="streamdriver-cafile">
<h4>streamDriver.CAFile<a class="headerlink" href="#streamdriver-cafile" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>global parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2108.0.</span></p>
</div>
<p>This permits to override the DefaultNetstreamDriverCAFile global parameter on the input()
level. For further details, see the global parameter.</p>
</section>
<section id="streamdriver-crlfile">
<h4>streamDriver.CRLFile<a class="headerlink" href="#streamdriver-crlfile" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>optional</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>global parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2308.0.</span></p>
</div>
<p>This permits to override the CRL (Certificate revocation list) file set via <cite>global()</cite> config
object at the per-action basis. This parameter is ignored if the netstream driver and/or its
mode does not need or support certificates.</p>
</section>
<section id="streamdriver-keyfile">
<h4>streamDriver.KeyFile<a class="headerlink" href="#streamdriver-keyfile" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>global parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2108.0.</span></p>
</div>
<p>This permits to override the DefaultNetstreamDriverKeyFile global parameter on the input()
level. For further details, see the global parameter.</p>
</section>
<section id="streamdriver-certfile">
<h4>streamDriver.CertFile<a class="headerlink" href="#streamdriver-certfile" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>global parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2108.0.</span></p>
</div>
<p>This permits to override the DefaultNetstreamDriverCertFile global parameter on the input()
level. For further details, see the global parameter.</p>
</section>
<section id="id10">
<h4>PermittedPeer<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>array</p></td>
<td><p>none</p></td>
<td><p>no</p></td>
<td><p>equally-named module parameter</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2112.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id11">
<h4>gnutlsPriorityString<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>string</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id12">
<h4>MaxSessions<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id13">
<h4>MaxListeners<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id14">
<h4>FlowControl<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id15">
<h4>DisableLFDelimiter<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id16">
<h4>DiscardTruncatedMsg<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id17">
<h4>NotifyOnConnectionClose<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id18">
<h4>AddtlFrameDelimiter<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id19">
<h4>MaxFrameSize<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id20">
<h4>PreserveCase<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>boolean</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id21">
<h4>KeepAlive<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>binary</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id22">
<h4>KeepAlive.Probes<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id23">
<h4>KeepAlive.Time<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
<section id="id24">
<h4>KeepAlive.Interval<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h4>
<div class="table-wrapper colwidths-auto parameter-table docutils container">
<table class="parameter-table docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>type</p></th>
<th class="head"><p>default</p></th>
<th class="head"><p>mandatory</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">obsolete</span> <span class="pre">legacy</span></code> directive</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>integer</p></td>
<td><p>module parameter</p></td>
<td><p>no</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.2106.0.</span></p>
</div>
<p>This permits to override the equally-named module parameter on the input()
level. For further details, see the module parameter.</p>
</section>
</section>
</section>
<section id="statistic-counter">
<span id="imtcp-statistic-counter"></span><h2>Statistic Counter<a class="headerlink" href="#statistic-counter" title="Link to this heading">¶</a></h2>
<p>This plugin maintains <a class="reference internal" href="../rsyslog_statistic_counter.html"><span class="doc">statistics</span></a> for each listener. The statistic is named
after the given input name (or “imtcp” if none is configured), followed by
the listener port in parenthesis. For example, the counter for a listener
on port 514 with no set name is called “imtcp(514)”.</p>
<p>The following properties are maintained for each listener:</p>
<ul class="simple">
<li><p><strong>submitted</strong> - total number of messages submitted for processing since startup</p></li>
</ul>
<section id="worker-statistics-counters">
<span id="imtcp-worker-statistics"></span><h3>Worker Statistics Counters<a class="headerlink" href="#worker-statistics-counters" title="Link to this heading">¶</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> operates with <strong>multiple worker threads</strong> (<code class="docutils literal notranslate"><span class="pre">workerthreads</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>),
it <strong>automatically generates statistics counters</strong> to provide insight into worker
activity and system health. These counters are part of the <code class="docutils literal notranslate"><span class="pre">impstats</span></code> module and
can be used to monitor system performance, detect bottlenecks, and analyze load
distribution among worker threads.</p>
<p><strong>Note:</strong> These counters <strong>do not exist</strong> if <code class="docutils literal notranslate"><span class="pre">workerthreads</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code>,
as <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> runs in single-threaded mode in that case.</p>
<p><strong>Statistics Counters</strong></p>
<p>Each worker thread reports its statistics using the format <code class="docutils literal notranslate"><span class="pre">tcpsrv/wX</span></code>,
where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the worker thread number (e.g., <code class="docutils literal notranslate"><span class="pre">tcpsrv/w0</span></code> for the first worker).
The following counters are available:</p>
<ul class="simple">
<li><p><strong>runs</strong> → Number of times the worker thread has been invoked.</p></li>
<li><p><strong>read</strong> → Number of read calls performed by the worker.
- For TLS connections, this includes both <strong>read</strong> and <strong>write</strong> calls.</p></li>
<li><p><strong>accept</strong> → Number of times this worker has processed a new connection via <code class="docutils literal notranslate"><span class="pre">accept()</span></code>.</p></li>
<li><p><strong>starvation_protect</strong> → Number of times a socket was placed back into the queue
due to reaching the <code class="docutils literal notranslate"><span class="pre">StarvationProtection.MaxReads</span></code> limit.</p></li>
</ul>
<p><strong>Example Output</strong>
An example of <code class="docutils literal notranslate"><span class="pre">impstats</span></code> output with three worker threads:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>10 Thu Feb 27 16:40:02 2025: tcpsrv/w0: origin=imtcp runs=72 read=2662 starvation_protect=1 accept=2
11 Thu Feb 27 16:40:02 2025: tcpsrv/w1: origin=imtcp runs=74 read=2676 starvation_protect=2 accept=0
12 Thu Feb 27 16:40:02 2025: tcpsrv/w2: origin=imtcp runs=72 read=1610 starvation_protect=0 accept=0
</pre></div>
</div>
<p>In this case:</p>
<ul class="simple">
<li><p>Worker <code class="docutils literal notranslate"><span class="pre">w0</span></code> was invoked <strong>72 times</strong>, performed <strong>2662 reads</strong>,
applied <strong>starvation protection once</strong>, and accepted <strong>2 connections</strong>.</p></li>
<li><p>Worker <code class="docutils literal notranslate"><span class="pre">w1</span></code> handled more reads but did not process any <code class="docutils literal notranslate"><span class="pre">accept()</span></code> calls.</p></li>
<li><p>Worker <code class="docutils literal notranslate"><span class="pre">w2</span></code> processed fewer reads and did not trigger starvation protection.</p></li>
</ul>
<p><strong>Usage and Monitoring</strong></p>
<ul class="simple">
<li><p>These counters help analyze how load is distributed across worker threads.</p></li>
<li><p>High <code class="docutils literal notranslate"><span class="pre">starvation_protect</span></code> values indicate that some connections are consuming
too many reads, potentially impacting fairness.</p></li>
<li><p>If a single worker handles <strong>most</strong> of the <code class="docutils literal notranslate"><span class="pre">accept()</span></code> calls, this may
indicate an imbalance in connection handling.</p></li>
<li><p>Regular monitoring can help optimize the <code class="docutils literal notranslate"><span class="pre">workerthreads</span></code> and
<code class="docutils literal notranslate"><span class="pre">StarvationProtection.MaxReads</span></code> parameters for better system efficiency.</p></li>
</ul>
<p>By using these statistics, administrators can fine-tune <code class="docutils literal notranslate"><span class="pre">imtcp</span></code> to ensure
<strong>fair resource distribution and optimal performance</strong> in high-traffic environments.</p>
</section>
</section>
<section id="caveats-known-bugs">
<h2>Caveats/Known Bugs<a class="headerlink" href="#caveats-known-bugs" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>module always binds to all interfaces</p></li>
<li><p>can not be loaded together with <a class="reference external" href="imgssapi.html">imgssapi</a> (which
includes the functionality of imtcp)</p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<section id="id26">
<h3>Example 1<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<p>This sets up a TCP server on port 514 and permits it to accept up to 500
connections:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>module(load=&quot;imtcp&quot; MaxSessions=&quot;500&quot;)
input(type=&quot;imtcp&quot; port=&quot;514&quot;)
</pre></div>
</div>
<p>Note that the global parameters (here: max sessions) need to be set when
the module is loaded. Otherwise, the parameters will not apply.</p>
</section>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://www.rsyslog.com/howto-store-remote-messages-in-a-separate-file/">rsyslog video tutorial on how to store remote messages in a separate file</a> (for legacy syntax, but you get the idea).</p></li>
</ul>
<hr class="docutils" />
<p><strong>Support:</strong> <a class="reference external" href="https://rsyslog.ai">rsyslog Assistant</a> |
<a class="reference external" href="https://github.com/rsyslog/rsyslog/discussions">GitHub Discussions</a> |
GitHub Issues: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a></p>
<p><strong>Contributing:</strong> Source &amp; docs: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a></p>
<p>© 2008–2025 <a class="reference external" href="https://rainer.gerhards.net/">Rainer Gerhards</a>
and others. Licensed under the <a class="reference external" href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="imtuxedoulog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">imtuxedoulog: Tuxedo ULOG input module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="imsolaris.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">imsolaris: Solaris Input Module</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">imtcp: TCP Syslog Input Module</a><ul>
<li><a class="reference internal" href="#purpose">Purpose</a></li>
<li><a class="reference internal" href="#notable-features">Notable Features</a><ul>
<li><a class="reference internal" href="#starvation-protection">Starvation Protection</a></li>
<li><a class="reference internal" href="#configurable-behavior">Configurable Behavior</a></li>
<li><a class="reference internal" href="#monitoring-and-performance-insights">Monitoring and Performance Insights</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configuration-parameters">Configuration Parameters</a><ul>
<li><a class="reference internal" href="#module-parameters">Module Parameters</a><ul>
<li><a class="reference internal" href="#addtlframedelimiter">AddtlFrameDelimiter</a></li>
<li><a class="reference internal" href="#disablelfdelimiter">DisableLFDelimiter</a></li>
<li><a class="reference internal" href="#maxframesize">MaxFrameSize</a></li>
<li><a class="reference internal" href="#notifyonconnectionopen">NotifyOnConnectionOpen</a></li>
<li><a class="reference internal" href="#id1">NotifyOnConnectionOpen</a></li>
<li><a class="reference internal" href="#notifyonconnectionclose">NotifyOnConnectionClose</a></li>
<li><a class="reference internal" href="#keepalive">KeepAlive</a></li>
<li><a class="reference internal" href="#keepalive-probes">KeepAlive.Probes</a></li>
<li><a class="reference internal" href="#keepalive-time">KeepAlive.Time</a></li>
<li><a class="reference internal" href="#keepalive-interval">KeepAlive.Interval</a></li>
<li><a class="reference internal" href="#flowcontrol">FlowControl</a></li>
<li><a class="reference internal" href="#maxlisteners">MaxListeners</a></li>
<li><a class="reference internal" href="#maxsessions">MaxSessions</a></li>
<li><a class="reference internal" href="#streamdriver-name">StreamDriver.Name</a></li>
<li><a class="reference internal" href="#workerthreads">WorkerThreads</a></li>
<li><a class="reference internal" href="#starvationprotection-maxreads">StarvationProtection.MaxReads</a></li>
<li><a class="reference internal" href="#streamdriver-mode">StreamDriver.Mode</a></li>
<li><a class="reference internal" href="#streamdriver-authmode">StreamDriver.AuthMode</a></li>
<li><a class="reference internal" href="#streamdriver-permitexpiredcerts">StreamDriver.PermitExpiredCerts</a></li>
<li><a class="reference internal" href="#streamdriver-checkextendedkeypurpose">StreamDriver.CheckExtendedKeyPurpose</a></li>
<li><a class="reference internal" href="#streamdriver-prioritizesan">StreamDriver.PrioritizeSAN</a></li>
<li><a class="reference internal" href="#streamdriver-tlsverifydepth">StreamDriver.TlsVerifyDepth</a></li>
<li><a class="reference internal" href="#permittedpeer">PermittedPeer</a></li>
<li><a class="reference internal" href="#discardtruncatedmsg">DiscardTruncatedMsg</a></li>
<li><a class="reference internal" href="#gnutlsprioritystring">gnutlsPriorityString</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-1">Example 1</a></li>
<li><a class="reference internal" href="#example-2">Example 2</a><ul>
<li><a class="reference internal" href="#preservecase">PreserveCase</a></li>
</ul>
</li>
<li><a class="reference internal" href="#input-parameters">Input Parameters</a><ul>
<li><a class="reference internal" href="#port">Port</a></li>
<li><a class="reference internal" href="#listenportfilename">ListenPortFileName</a></li>
<li><a class="reference internal" href="#address">Address</a></li>
<li><a class="reference internal" href="#name">Name</a></li>
<li><a class="reference internal" href="#ruleset">Ruleset</a></li>
<li><a class="reference internal" href="#supportoctetcountedframing">SupportOctetCountedFraming</a></li>
<li><a class="reference internal" href="#socketbacklog">SocketBacklog</a></li>
<li><a class="reference internal" href="#ratelimit-interval">RateLimit.Interval</a></li>
<li><a class="reference internal" href="#ratelimit-burst">RateLimit.Burst</a></li>
<li><a class="reference internal" href="#id2">listenPortFileName</a></li>
<li><a class="reference internal" href="#id3">StreamDriver.Name</a></li>
<li><a class="reference internal" href="#id4">StreamDriver.Mode</a></li>
<li><a class="reference internal" href="#id5">StreamDriver.AuthMode</a></li>
<li><a class="reference internal" href="#id6">StreamDriver.PermitExpiredCerts</a></li>
<li><a class="reference internal" href="#id7">StreamDriver.CheckExtendedKeyPurpose</a></li>
<li><a class="reference internal" href="#id8">StreamDriver.PrioritizeSAN</a></li>
<li><a class="reference internal" href="#id9">StreamDriver.TlsVerifyDepth</a></li>
<li><a class="reference internal" href="#streamdriver-cafile">streamDriver.CAFile</a></li>
<li><a class="reference internal" href="#streamdriver-crlfile">streamDriver.CRLFile</a></li>
<li><a class="reference internal" href="#streamdriver-keyfile">streamDriver.KeyFile</a></li>
<li><a class="reference internal" href="#streamdriver-certfile">streamDriver.CertFile</a></li>
<li><a class="reference internal" href="#id10">PermittedPeer</a></li>
<li><a class="reference internal" href="#id11">gnutlsPriorityString</a></li>
<li><a class="reference internal" href="#id12">MaxSessions</a></li>
<li><a class="reference internal" href="#id13">MaxListeners</a></li>
<li><a class="reference internal" href="#id14">FlowControl</a></li>
<li><a class="reference internal" href="#id15">DisableLFDelimiter</a></li>
<li><a class="reference internal" href="#id16">DiscardTruncatedMsg</a></li>
<li><a class="reference internal" href="#id17">NotifyOnConnectionClose</a></li>
<li><a class="reference internal" href="#id18">AddtlFrameDelimiter</a></li>
<li><a class="reference internal" href="#id19">MaxFrameSize</a></li>
<li><a class="reference internal" href="#id20">PreserveCase</a></li>
<li><a class="reference internal" href="#id21">KeepAlive</a></li>
<li><a class="reference internal" href="#id22">KeepAlive.Probes</a></li>
<li><a class="reference internal" href="#id23">KeepAlive.Time</a></li>
<li><a class="reference internal" href="#id24">KeepAlive.Interval</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#statistic-counter">Statistic Counter</a><ul>
<li><a class="reference internal" href="#worker-statistics-counters">Worker Statistics Counters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#caveats-known-bugs">Caveats/Known Bugs</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#id26">Example 1</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=6fd4f6cc"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>