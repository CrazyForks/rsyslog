<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Turning Lanes and Rsyslog Queues" href="queues_analogy.html" /><link rel="prev" title="syslog parsing in rsyslog" href="syslog_parsing.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>syslog-protocol support in rsyslog - rsyslog 8.2508 daily stable documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../_static/rsyslog.css?v=6406a7f4" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">rsyslog 8.2508 daily stable documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">rsyslog 8.2508 daily stable documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../about/index.html">About rsyslog</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of About rsyslog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../about/ai_first.html">AI-First: Our Vision for rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about/history.html">History and Future of rsyslog</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/index.html">Getting Started with rsyslog</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Getting Started with rsyslog</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html">Installing rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/basic_configuration.html">Basic Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/understanding_default_config.html">Understanding the Default Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/forwarding_logs.html">Forwarding Logs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/next_steps.html">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../configuration/index.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Configuration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/basic_structure.html">Basic Structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_output.html">Output Modules</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Output Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omamqp1.html">omamqp1: AMQP 1.0 Messaging Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omazureeventhubs.html">omazureeventhubs: Microsoft Azure Event Hubs Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omclickhouse.html">omclickhouse: ClickHouse Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omczmq.html">omczmq: Output module for ZeroMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omdtls.html">omdtls: Output Module for DTLS Protocol over UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omelasticsearch.html">omelasticsearch: Elasticsearch Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omfile.html">omfile: File Output Module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/modules/omfwd.html">omfwd: syslog Forwarding Output Module</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of omfwd: syslog Forwarding Output Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/modules/omfwd/parameters/basic.html">Basic Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/modules/omfwd/parameters/module.html">Module Parameters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhdfs.html">omhdfs: Hadoop Filesystem Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhiredis.html">omhiredis: Redis Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhttp.html">omhttp: HTTP Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omhttpfs.html">omhttpfs: Hadoop HTTPFS Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omjournal.html">omjournal: Systemd Journal Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omkafka.html">omkafka: write to Apache Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omlibdbi.html">omlibdbi: Generic Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ommail.html">ommail: Mail Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ommongodb.html">ommongodb: MongoDB Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ommysql.html">ommysql: MariaDB/MySQL Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omoracle.html">omoracle: Oracle Database Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ompgsql.html">PostgreSQL Database Output Module (ompgsql)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/ompipe.html">ompipe: Pipe Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omprog.html">omprog: Program integration Output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omrabbitmq.html">omrabbitmq: RabbitMQ output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omrelp.html">omrelp: RELP Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omruleset.html">omruleset: ruleset output/including module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omsendertrack.html">omsendertrack: Sender Tracking Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omsnmp.html">omsnmp: SNMP Trap Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omstdout.html">omstdout: stdout output module (testbench tool)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omudpspoof.html">omudpspoof: UDP spoofing output module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omusrmsg.html">omusrmsg: notify users</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/omuxsock.html">omuxsock: Unix sockets Output Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/sigprov_gt.html">GuardTime Log Signature Provider (gt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/sigprov_ksi.html">Keyless Signature Infrastructure Provider (ksi)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/sigprov_ksi12.html">KSI Signature Provider (rsyslog-ksi-ls12)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_input.html">Input Modules</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Input Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/im3195.html">im3195: RFC3195 Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imbatchreport.html">imbatchreport: Batch report input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imczmq.html">imczmq: Input module for ZeroMQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imdocker.html">imdocker: Docker Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imdtls.html">imdtls: Input Module for DTLS Protocol over UDP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imfile.html">imfile: Text File Input Module</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/modules/imgssapi.html">imgssapi: GSSAPI Syslog Input Module</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of imgssapi: GSSAPI Syslog Input Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/modules/gssapi.html">GSSAPI module support in rsyslog v3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imhiredis.html">Imhiredis: Redis input plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imhttp.html">imhttp: HTTP input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imjournal.html">imjournal: Systemd Journal Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imkafka.html">imkafka: read from Apache Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imklog.html">imklog: Kernel Log Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imkmsg.html">imkmsg: /dev/kmsg Log Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/immark.html">immark: Mark Message Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/impcap.html">Impcap: network traffic capture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/improg.html">improg: Program integration input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/impstats.html">impstats: Generate Periodic Statistics of Internal Counters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imptcp.html">imptcp: Plain TCP Syslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imrelp.html">imrelp: RELP Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imsolaris.html">imsolaris: Solaris Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imtcp.html">imtcp: TCP Syslog Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imtuxedoulog.html">imtuxedoulog: Tuxedo ULOG input module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imudp.html">imudp: UDP Syslog Input Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/imuxsock.html">imuxsock: Unix Socket Input Module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_parser.html">Parser Modules</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Parser Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmciscoios.html">pmciscoios</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmdb2diag.html">pmdb2diag: DB2 Diag file parser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmlastmsg.html">pmlastmsg: last message repeated n times</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmnormalize.html">Log Message Normalization Parser Module (pmnormalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmnull.html">pmnull: Syslog Null Parser Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmrfc3164.html">pmrfc3164: Parse RFC3164-formatted messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmrfc3164sd.html">pmrfc3164sd: Parse RFC5424 structured data inside RFC3164 messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/pmrfc5424.html">pmrfc5424: Parse RFC5424-formatted messages</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/idx_messagemod.html">Message Modification Modules</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Message Modification Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmaitag.html">AI-based classification (mmaitag)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmanon.html">IP Address Anonymization Module (mmanon)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmcount.html">mmcount</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmdarwin.html">Darwin connector (mmdarwin)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmdblookup.html">MaxMind/GeoIP DB lookup (mmdblookup)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmexternal.html">Support module for external message modification modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmfields.html">Fields Extraction Module (mmfields)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmjsonparse.html">JSON/CEE Structured Content Extraction Module (mmjsonparse)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmkubernetes.html">Kubernetes Metadata Module (mmkubernetes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmnormalize.html">Log Message Normalization Module (mmnormalize)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmpstrucdata.html">RFC5424 structured data parsing module (mmpstrucdata)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmrfc5424addhmac.html">mmrfc5424addhmac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmrm1stspace.html">mmrm1stspace: First Space Modification Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmsequence.html">Number generator and counter module (mmsequence)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmsnmptrapd.html">mmsnmptrapd message modification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmtaghostname.html">mmtaghostname: message modification module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/mmutf8fix.html">Fix invalid UTF-8 Sequences (mmutf8fix)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/modules/idx_stringgen.html">String Generator Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/modules/idx_library.html">Library Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/templates.html">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/properties.html">rsyslog Properties</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/property_replacer.html">The Property Replacer</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of The Property Replacer</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/nomatch.html">Property Replacer nomatch mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/filters.html">Filter Conditions</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../rainerscript/index.html">RainerScript</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of RainerScript</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/data_types.html">Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/expressions.html">Expressions</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../rainerscript/functions/index.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../rainerscript/functions/idx_built-in_functions.html">Built-in Functions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Built-in Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-cnum.html">cnum()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-cstr.html">cstr()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-dyn_inc.html">dyn_inc()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-exec_template.html">exec_template()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-exists.html">exists()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-field.html">field()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-format_time.html">format_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-get_property.html">get_property()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-getenv.html">getenv()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-int2hex.html">int2hex()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-ipv4convert.html">num2ipv4() / ipv42num()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-is_time.html">is_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-lookup.html">lookup()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-parse_json.html">parse_json()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-parse_time.html">parse_time()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-percentile_observe.html">percentile_observe()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-previous_action_suspended.html">previous_action_suspended()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-prifilt.html">prifilt()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-random.html">random()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_extract.html">re_extract()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_extract_i.html">re_extract_i()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_match.html">re_match()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-re_match_i.html">re_match_i()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-replace.html">replace()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-script_error.html">script_error()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-strlen.html">strlen()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-substring.html">substring()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-tolower.html">tolower()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-trim.html">ltrim() / rtrim()</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/rs-wrap.html">wrap()</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../rainerscript/functions/idx_module_functions.html">Module Functions</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Module Functions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-ffaup.html">Faup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-hashXX.html">HashXX</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-hashXXmod.html">HashXXmod</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-http_request.html">HTTP-Request</a></li>
<li class="toctree-l5"><a class="reference internal" href="../rainerscript/functions/mo-unflatten.html">Unflatten</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/control_structures.html">Control Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/configuration_objects.html">configuration objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/constant_strings.html">String Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/variable_property_types.html">Variable (Property) types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/lookup_tables.html">Lookup Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/queue_parameters.html">General Queue Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/rainerscript_call.html">The rsyslog “call” statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/rainerscript_call_indirect.html">The rsyslog “call_indirect” statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/global.html">global() configuration object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rainerscript/include.html">The rsyslog include() object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/input.html">Input</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/parser.html">Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/timezone.html">timezone</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/examples.html">Examples</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/index_directives.html">Legacy Configuration Directives</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Legacy Configuration Directives</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/config_param_types.html">Configuration Parameter Types</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/global/index.html">Legacy Global Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Legacy Global Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_abortonuncleanconfig.html">$AbortOnUncleanConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_debugprintcfsyslinehandlerlist.html">$DebugPrintCFSyslineHandlerList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_debugprintmodulelist.html">$DebugPrintModuleList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_debugprinttemplatelist.html">$DebugPrintTemplateList</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_failonchownfailure.html">$FailOnChownFailure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_generateconfiggraph.html">$GenerateConfigGraph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_includeconfig.html">$IncludeConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_mainmsgqueuesize.html">$MainMsgQueueSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_maxopenfiles.html">$MaxOpenFiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_moddir.html">$ModDir</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_modload.html">$ModLoad</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_umask.html">$UMASK</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/global/options/rsconf1_resetconfigvariables.html">$ResetConfigVariables</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/input_directives/index.html">Legacy Directives affecting Input Modules</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Legacy Directives affecting Input Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_allowedsender.html">$AllowedSender</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_dropmsgswithmaliciousdnsptrrecords.html">$DropMsgsWithMaliciousDnsPTRRecords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_controlcharacterescapeprefix.html">$ControlCharacterEscapePrefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_droptrailinglfonreception.html">$DropTrailingLFOnReception</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_escape8bitcharsonreceive.html">$Escape8BitCharactersOnReceive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_escapecontrolcharactersonreceive.html">$EscapeControlCharactersOnReceive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/input_directives/rsconf1_markmessageperiod.html">$MarkMessagePeriod</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/action/index.html">Depricated Legacy Action-Specific Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Depricated Legacy Action-Specific Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_actionexeconlywhenpreviousissuspended.html">How to Convert Deprecated <cite>$ActionExecOnlyWhenPreviousIsSuspended</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_actionresumeinterval.html">How to Convert Deprecated <cite>$ActionResumeInterval</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_repeatedmsgreduction.html">$RepeatedMsgReduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_omfileforcechown.html">$omfileForceChown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_dirgroup.html">$DirGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_dirowner.html">How to Convert Deprecated <cite>$DirOwner</cite> to Modern Style</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_dynafilecachesize.html">$DynaFileCacheSize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_filecreatemode.html">$FileCreateMode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_filegroup.html">$FileGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_fileowner.html">$FileOwner</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_gssforwardservicename.html">$GssForwardServiceName</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/action/rsconf1_gssmode.html">$GssMode</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../configuration/ruleset/index.html">Ruleset-Specific Legacy Configuration Statements</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Ruleset-Specific Legacy Configuration Statements</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../configuration/ruleset/rsconf1_rulesetcreatemainqueue.html">$RulesetCreateMainQueue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../configuration/ruleset/rsconf1_rulesetparser.html">$RulesetParser</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/rsyslog_statistic_counter.html">rsyslog statistic counter</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../configuration/modules/index.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/modules/workflow.html">Where are the modules integrated into the Message Flow?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/output_channels.html">Output Channels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/droppriv.html">Dropping privileges in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/ipv6.html">Notes on IPv6 Handling in Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/cryprov_gcry.html">libgcrypt Log Crypto Provider (gcry)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/cryprov_ossl.html">libossl Log Crypto Provider (ossl)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/dyn_stats.html">Dynamic Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/lookup_tables.html">Lookup Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/percentile_stats.html">Percentile Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/converting_to_new_format.html">Converting older formats to <code class="docutils literal notranslate"><span class="pre">advanced</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/conf_formats.html">Configuration Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/sysklogd_format.html">sysklogd format</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../faq/index.html">FAQ</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of FAQ</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/faq_overall.html">FAQ: some general topics often asked</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/difference_queues.html">What is the difference between the main_queue and a queue with a ruleset tied to an input?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/encrypt_mysql_traffic_ommysql.html">FAQ: Encrypting MySQL Traffic with ommysql Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/imudp-packet-loss.html">FAQ: Troubleshooting UDP Packet Loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/common-config-mistakes.html">Common Configuration Mistakes and Misunderstandings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/tls_cert_summary.html">Encrypting Syslog Traffic with TLS (SSL)</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Encrypting Syslog Traffic with TLS (SSL)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_scenario.html">Sample Use Case: Single Central Log Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_ca.html">Setting up the CA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_machine.html">Generating the machine certificate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_server.html">Setting up the Central Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_client.html">Setting up a client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_udp_relay.html">Setting up the UDP syslog relay</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_errmsgs.html">Error Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/tls_cert_script.html">Creating certificates with a script</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/tls.html">Encrypting Syslog Traffic with TLS (SSL) [short version]</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/database.html">Writing syslog messages to MariaDB, MySQL, PostgreSQL or any other supported Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/high_database_rate.html">Handling a massive syslog database insert rate with Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/reliable_forwarding.html">Reliable Forwarding of syslog Messages with Rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/recording_pri.html">Recording the Priority of Syslog Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/failover_syslog_server.html">Failover Syslog Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/log_rotation_fix_size.html">Log rotation with rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/gelf_forwarding.html">GELF forwarding in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/log_sampling.html">Log Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/random_sampling.html">Random sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/hash_sampling.html">Hash-based Sampling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Troubleshooting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/file_not_written.html">Output File is not Being Written</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/selinux.html">Troubleshooting SELinux-Related Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/debug.html">Rsyslog Debug Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/troubleshoot.html">troubleshooting problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting/howtodebug.html">How to create a debug log</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../concepts/index.html">Concepts</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Concepts</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/queues.html">Understanding rsyslog Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/janitor.html">The Janitor Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/messageparser.html">Message parsers in rsyslog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/multi_ruleset.html">Multiple Rulesets in rsyslog</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../concepts/netstrm_drvr.html">NetStream Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of NetStream Drivers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_ptcp.html">ptcp Network Stream Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html">gtls Network Stream Driver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#supported-driver-modes">Supported Driver Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#supported-authentication-modes">Supported Authentication Modes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#checkextendedkeypurpose">CheckExtendedKeyPurpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_gtls.html#prioritizesan">PrioritizeSAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/ns_ossl.html">openssl Network Stream Driver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../development/index.html">Development</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Development</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/config_data_model.html">The rsyslog config data model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/config_data_model.html#objects">Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/debugging.html">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/dev_action_threads.html">Action Threads and Queue Engine (Developer-Oriented)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/dev_codestyle.html">rsyslog code style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/dev_oplugins.html">Writing Rsyslog Output Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/dev_queue.html">The rsyslog queue object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/dev_testbench.html">writing rsyslog tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/doc_reference_section_guidelines.html">Documentation Reference Section Structure Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/doc_style_guide.html">Documentation Style Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/generic_design.html">Generic design of a syslogd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/internal_tooling.html">Internal tooling</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../idx_reference.html">Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../containers/index.html">rsyslog and containers</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of rsyslog and containers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../containers/container_features.html">Container-Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../containers/docker_specifics.html">docker specifics</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../installation/index.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/packages.html">Installing rsyslog from Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/rsyslog_docker.html">Using Rsyslog Docker Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/install_from_source.html">Installing rsyslog from Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/build_from_repo.html">Installing rsyslog from the source repository</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../historical/index.html">Historical Documents</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Historical Documents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../historical/php_syslog_ng.html">Using php-syslog-ng with rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/multi_ruleset_legacy_format_samples.html">Legacy Format Samples for Multiple Rulesets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/module_devel.html">Developing rsyslog modules (outdated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/high_performance.html">Receiving massive amounts of messages with high performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v8compatibility.html">Compatibility Notes for rsyslog v8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v7compatibility.html">Compatibility Notes for rsyslog v7</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v6compatibility.html">Compatibility Notes for rsyslog v6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v5compatibility.html">Compatibility Notes for rsyslog v5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v4compatibility.html">Compatibility Notes for rsyslog v4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../historical/v3compatibility.html">Compatibility Notes for rsyslog v3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../history.html">RSyslog - History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../licensing.html">Licensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how2help.html">How you can Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community.html">Community Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features.html">RSyslog - Features</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../proposals/index.html">Proposals</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Proposals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../proposals/version_naming.html">Version Naming</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Rsyslog Whitepapers</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Rsyslog Whitepapers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="syslog_parsing.html">syslog parsing in rsyslog</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">syslog-protocol support in rsyslog</a></li>
<li class="toctree-l3"><a class="reference internal" href="queues_analogy.html">Turning Lanes and Rsyslog Queues</a></li>
<li class="toctree-l3"><a class="reference internal" href="preserve_in_nat.html">Preserving syslog sender over NAT</a></li>
<li class="toctree-l3"><a class="reference internal" href="reliable_logging.html">How reliable should reliable logging be?</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/whitepapers/syslog_protocol.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="syslog-protocol-support-in-rsyslog">
<h1>syslog-protocol support in rsyslog<a class="headerlink" href="#syslog-protocol-support-in-rsyslog" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="http://www.rsyslog.com/">rsyslog</a> <strong>provides a trial implementation
of the proposed</strong>
<a class="reference external" href="http://www.monitorware.com/Common/en/glossary/syslog-protocol.php">syslog-protocol</a>
<strong>standard.</strong> The intention of this implementation is to find out what
inside syslog-protocol is causing problems during implementation. As
syslog-protocol is a standard under development, its support in rsyslog
is highly volatile. It may change from release to release. So while it
provides some advantages in the real world, users are cautioned against
using it right now. If you do, be prepared that you will probably need
to update all of your rsyslogds with each new release. If you try it
anyhow, please provide feedback as that would be most beneficial for us.</p>
<section id="currently-supported-message-format">
<h2>Currently supported message format<a class="headerlink" href="#currently-supported-message-format" title="Link to this heading">¶</a></h2>
<p>Due to recent discussion on syslog-protocol, we do not follow any
specific revision of the draft but rather the candidate ideas. The
format supported currently is:</p>
<p><strong>``&lt;PRI&gt;VERSION SP TIMESTAMP SP HOSTNAME SP APP-NAME SP PROCID SP MSGID SP [SD-ID]s  SP MSG``</strong></p>
<p>Field syntax and semantics are as defined in IETF I-D
syslog-protocol-15.</p>
</section>
<section id="capabilities-implemented">
<h2>Capabilities Implemented<a class="headerlink" href="#capabilities-implemented" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>receiving message in the supported format (see above)</p></li>
<li><p>sending messages in the supported format</p></li>
<li><p>relaying messages</p></li>
<li><p>receiving messages in either legacy or -protocol format and
transforming them into the other one</p></li>
<li><p>virtual availability of TAG, PROCID, APP-NAME, MSGID, SD-ID no matter
if the message was received via legacy format, API or syslog-protocol
format (non-present fields are being emulated with great success)</p></li>
<li><p>maximum message size is set via preprocessor #define</p></li>
<li><p>syslog-protocol messages can be transmitted both over UDP and plain
TCP with some restrictions on compliance in the case of TCP</p></li>
</ul>
</section>
<section id="findings">
<h2>Findings<a class="headerlink" href="#findings" title="Link to this heading">¶</a></h2>
<p>This lists what has been found during implementation:</p>
<ul class="simple">
<li><p>The same receiver must be able to support both legacy and
syslog-protocol syslog messages. Anything else would be a big
inconvenience to users and would make deployment much harder. The
detection must be done automatically (see below on how easy that is).</p></li>
<li><p><strong>NUL characters inside MSG</strong> cause the message to be truncated at
that point. This is probably a major point for many C-based
implementations. No measures have yet been taken against this.
Modifying the code to “cleanly” support NUL characters is
non-trivial, even though rsyslogd already has some byte-counted
string library (but this is new and not yet available everywhere).</p></li>
<li><p><strong>character encoding in MSG</strong>: it is problematic to do the right
UTF-8 encoding. The reason is that we pick up the MSG from the local
domain socket (which got it from the syslog(3) API). The text
obtained does not include any encoding information, but it does
include non US-ASCII characters. It may also include any other
encoding. Other than by guessing based on the provided text, I have
no way to find out what it is. In order to make the syslogd do
anything useful, I have now simply taken the message as is and
stuffed it into the MSG part. Please note that I think this will be a
route that other implementors would take, too.</p></li>
<li><p>A minimal parser is easy to implement. It took me roughly 2 hours to
add it to rsyslogd. This includes the time for restructuring the code
to be able to parse both legacy syslog as well as syslog-protocol.
The parser has some restrictions, though</p>
<ul>
<li><p>STRUCTURED-DATA field is extracted, but not validated. Structured
data “[test ]]” is not caught as an error. Nor are any other
errors caught. For my needs with this syslogd, that level of
structured data processing is probably sufficient. I do not want
to parse/validate it in all cases. This is also a performance
issue. I think other implementors could have the same view. As
such, we should not make validation a requirement.</p></li>
<li><p>MSG is not further processed (e.g. Unicode not being validated)</p></li>
<li><p>the other header fields are also extracted, but no validation is
performed right now. At least some validation should be easy to
add (not done this because it is a proof-of-concept and scheduled
to change).</p></li>
</ul>
</li>
<li><p>Universal access to all syslog fields (missing ones being emulated)
was also quite easy. It took me around another 2 hours to integrate
emulation of non-present fields into the code base.</p></li>
<li><p>The version at the start of the message makes it easy to detect if we
have legacy syslog or syslog-protocol. Do NOT move it to somewhere
inside the middle of the message, that would complicate things. It
might not be totally fail-safe to just rely on “1 “ as the “cookie”
for a syslog-protocol. Eventually, it would be good to add some more
uniqueness, e.g. “&#64;#1 “.</p></li>
<li><p>I have no (easy) way to detect truncation if that happens on the UDP
stack. All I see is that I receive e.g. a 4K message. If the message
was e.g. 6K, I received two chunks. The first chunk (4K) is correctly
detected as a syslog-protocol message, the second (2K) as legacy
syslog. I do not see what we could do against this. This questions
the usefulness of the TRUNCATE bit. Eventually, I could look at the
UDP headers and see that it is a fragment. I have looked at a network
sniffer log of the conversation. This looks like two
totally-independent messages were sent by the sender stack.</p></li>
<li><p>The maximum message size is currently being configured via a
preprocessor #define. It can easily be set to 2K or 4K, but more than
4K is not possible because of UDP stack limitations. Eventually, this
can be worked around, but I have not done this yet.</p></li>
<li><p>rsyslogd can accept syslog-protocol formatted messages but is able to
relay them in legacy format. I find this a must in real-life
deployments. For this, I needed to do some field mapping so that
APP-NAME/PROCID are mapped into a TAG.</p></li>
<li><p>rsyslogd can also accept legacy syslog message and relay them in
syslog-protocol format. For this, I needed to apply some sub-parsing
of the TAG, which on most occasions provides correct results. There
might be some misinterpretations but I consider these to be mostly
non-intrusive.</p></li>
<li><p>Messages received from the syslog API (the normal case under *nix)
also do not have APP-NAME and PROCID and I must parse them out of TAG
as described directly above. As such, this algorithm is absolutely
vital to make things work on *nix.</p></li>
<li><p>I have an issue with messages received via the syslog(3) API (or, to
be more precise, via the local domain socket this API writes to):
These messages contain a timestamp, but that timestamp does neither
have the year nor the high-resolution time. The year is no real
issue, I just take the year of the reception of that message. There
is a very small window of exposure for messages read from the log
immediately after midnight Jan 1st. The message in the domain socket
might have been written immediately before midnight in the old year.
I think this is acceptable. However, I can not assign a
high-precision timestamp, at least it is somewhat off if I take the
timestamp from message reception on the local socket. An alternative
might be to ignore the timestamp present and instead use that one
when the message is pulled from the local socket (I am talking about
IPC, not the network - just a reminder…). This is doable, but
eventually not advisable. It looks like this needs to be resolved via
a configuration option.</p></li>
<li><p>rsyslogd already advertised its origin information on application
startup (in a syslog-protocol-14 compatible format). It is fairly
easy to include that with any message if desired (not currently
done).</p></li>
<li><p>A big problem I noticed are malformed messages. In -syslog-protocol,
we recommend/require to discard malformed messages. However, in
practice users would like to see everything that the syslogd
receives, even if it is in error. For the first version, I have not
included any error handling at all. However, I think I would
deliberately ignore any “discard” requirement. My current point of
view is that in my code I would eventually flag a message as being
invalid and allow the user to filter on this invalidness. So these
invalid messages could be redirected into special bins.</p></li>
<li><p>The error logging recommendations (those I insisted on;)) are not
really practical. My application has its own error logging philosophy
and I will not change this to follow a draft.</p></li>
<li><p>Relevance of support for leap seconds and senders without knowledge
of time is questionable. I have not made any specific provisions in
the code nor would I know how to handle that differently. I could,
however, pull the local reception timestamp in this case, so it might
be useful to have this feature. I do not think any more about this
for the initial proof-of-concept. Note it as a potential problem
area, especially when logging to databases.</p></li>
<li><p>The HOSTNAME field for internally generated messages currently
contains the hostname part only, not the FQDN. This can be changed
inside the code base, but it requires some thinking so that thinks
are kept compatible with legacy syslog. I have not done this for the
proof-of-concept, but I think it is not really bad. Maybe an hour or
half a day of thinking.</p></li>
<li><p>It is possible that I did not receive a TAG with legacy syslog or via
the syslog API. In this case, I can not generate the APP-NAME. For
consistency, I have used “-” in such cases (just like in PROCID,
MSGID and STRUCTURED-DATA).</p></li>
<li><p>As an architectural side-effect, syslog-protocol formatted messages
can also be transmitted over non-standard syslog/raw tcp. This
implementation uses the industry-standard LF termination of tcp
syslog records. As such, syslog-protocol messages containing an LF
will be broken invalidly. There is nothing that can be done against
this without specifying a TCP transport. This issue might be more
important than one thinks on first thought. The reason is the wide
deployment of syslog/tcp via industry standard.</p></li>
</ul>
<p><strong>Some notes on syslog-transport-udp-06</strong></p>
<ul class="simple">
<li><p>I did not make any low-level modifications to the UDP code and think
I am still basically covered with this I-D.</p></li>
<li><p>I deliberately violate section 3.3 insofar as that I do not
necessarily accept messages destined to port 514. This feature is
user-required and a must. The same applies to the destination port. I
am not sure if the “MUST” in section 3.3 was meant that this MUST be
an option, but not necessarily be active. The wording should be
clarified.</p></li>
<li><p>section 3.6: I do not check checksums. See the issue with discarding
messages above. The same solution will probably be applied in my
code.</p></li>
</ul>
</section>
<section id="conclusions-suggestions">
<h2>Conclusions/Suggestions<a class="headerlink" href="#conclusions-suggestions" title="Link to this heading">¶</a></h2>
<p>These are my personal conclusions and suggestions. Obviously, they must
be discussed ;)</p>
<ul class="simple">
<li><p>NUL should be disallowed in MSG</p></li>
<li><p>As it is not possible to definitely know the character encoding of
the application-provided message, MSG should <strong>not</strong> be specified to
use UTF-8 exclusively. Instead, it is suggested that any encoding may
be used but UTF-8 is preferred. To detect UTF-8, the MSG should start
with the UTF-8 byte order mask of “EF BB BF” if it is UTF-8 encoded
(see section 155.9 of
<a class="reference external" href="https://www.unicode.org/versions/Unicode4.0.0/ch15.pdf">https://www.unicode.org/versions/Unicode4.0.0/ch15.pdf</a>)</p></li>
<li><p>Requirements to drop messages should be reconsidered. I guess I would
not be the only implementor ignoring them.</p></li>
<li><p>Logging requirements should be reconsidered and probably be removed.</p></li>
<li><p>It would be advisable to specify “-” for APP-NAME is the name is not
known to the sender.</p></li>
<li><p>The implications of the current syslog/tcp industry standard on
syslog-protocol should be further evaluated and be fully understood</p></li>
</ul>
<hr class="docutils" />
<p><strong>Support:</strong> <a class="reference external" href="https://rsyslog.ai">rsyslog Assistant</a> |
<a class="reference external" href="https://github.com/rsyslog/rsyslog/discussions">GitHub Discussions</a> |
GitHub Issues: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a></p>
<p><strong>Contributing:</strong> Source &amp; docs: <a class="reference external" href="https://github.com/rsyslog/rsyslog/">rsyslog source project</a></p>
<p>© 2008–2025 <a class="reference external" href="https://rainer.gerhards.net/">Rainer Gerhards</a>
and others. Licensed under the <a class="reference external" href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="queues_analogy.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Turning Lanes and Rsyslog Queues</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="syslog_parsing.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">syslog parsing in rsyslog</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">syslog-protocol support in rsyslog</a><ul>
<li><a class="reference internal" href="#currently-supported-message-format">Currently supported message format</a></li>
<li><a class="reference internal" href="#capabilities-implemented">Capabilities Implemented</a></li>
<li><a class="reference internal" href="#findings">Findings</a></li>
<li><a class="reference internal" href="#conclusions-suggestions">Conclusions/Suggestions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=6fd4f6cc"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>